% ===== CHAPTER 8 =====
\chapter{变分法}
\label{chap:8}
\section{变分理论}
\label{sec:8.1 The Variation Theorem}
    为了处理包含相互作用粒子系统（如原子和分子）的定态薛定谔方程，我们必须使用近似方法。本章讨论变分法，它允许我们在不求解薛定谔方程的情况下近似得到系统的基态能量。变分法基于如下理论：
    \begin{center}
        \parbox{0.8\textwidth}{
            \textbf{变分理论：}
            
            给定一个系统，其哈密顿算符$\hat{H}$与时间无关，其最低能量本征值为$E_1$，如果 $\phi$ 是系统粒子坐标的任何满足问题定解条件的已归一化品优函数，那么
            \begin{equation}
                \boxed{
                    \int \phi^{\ast}\hat{H}\:\mathrm{d}\tau \geq E_1, \quad \phi \text{已归一化}
                }
                \label{eq:8.1}
            \end{equation}
        }
    \end{center}

    变分理论允许我们计算系统基态能量的最大值。

    为了证明(\ref{eq:8.1})，我们将$\phi$用$\hat{H}$的本征函数完全正交集，即定态本征函数$\psi_k$展开：
    \begin{equation}
        \phi = \sum_k a_k \psi_k
        \label{eq:8.2}
    \end{equation}
    其中
    \begin{equation}
        \hat{H}\psi_k = E_k \psi_k
        \label{eq:8.3}
    \end{equation}
    注意：展开式(\ref{eq:8.2})要求$\phi$满足与$\psi_k$相同的定解条件。将(\ref{eq:8.2})代入(\ref{eq:8.1})的左侧，我们得到
    \begin{equation*}
        \int \phi^{\ast}\hat{H}\phi\:\mathrm{d}\tau = \int \sum_{k}a_k^{\ast} \psi_k^{\ast} \hat{H} \sum_{j} a_j \psi_j \:\mathrm{d}\tau = \int \sum_{k}a_k^{\ast} \psi_k^{\ast} \sum_{j} a_j \hat{H} \psi_j \:\mathrm{d}\tau
    \end{equation*}
    利用本征方程 (\ref{eq:8.3})，并假设交换积分和无限求和是成立的，我们可以得到
    \begin{equation*}
        \begin{aligned}
            \int \phi^{\ast}\hat{H}\phi \:\mathrm{d}\tau &= \int \sum_{k} a_k^{\ast} \psi_k^{\ast} \hat{H} \sum_{j} a_j \psi_j \:\mathrm{d}\tau = \int \sum_{k} a_k^{\ast} \psi_k^{\ast} \sum_{j} a_j \hat{H} \psi_j \:\mathrm{d}\tau \\
            &= \sum_k\sum_{j} a_k^{\ast} a_j E_j \delta_{kj}
        \end{aligned}
    \end{equation*}
    其中用到了本征函数$\psi_k$的正交性。我们对 $j$ 求和，像往常一样，除了 $j=k$ 的项之外，Kronecker $\delta$使所有项都为零，从而得到
    \begin{equation}
        \int \phi^{\ast} \hat{H}\phi \:\mathrm{d}\tau = \sum_{k}a_k^{\ast} a_k E_k = \sum_k |a_k|^2 E_k
        \label{eq:8.4}
    \end{equation}
    
    由于$E_1$是$\hat{H}$的最低能量本征值，我们有$E_k \geq E_1$，又由于$\left|a_k\right|^2$为非负数，我们可以将不等式$E_k \geq E_1$的左右两侧乘以$|a_k|^2$而不改变不等号的方向，从而得到$|a_k|^2 E_k \geq |a_k|^2 E_1$。因此，$\sum_k |a_k|^2 E_k \geq \sum_k |a_k|^2 E_1$，使用(\ref{eq:8.4})，我们得到
    \begin{equation}
        \int \phi^{\ast} \hat{H}\phi \:\mathrm{d}\tau = \sum_k |a_k|^2 E_k \geq \sum_k |a_k|^2 E_1 = E_1 \sum_k |a_k|^2
        \label{eq:8.5}
    \end{equation}

    因为$\phi$已归一化，我们有$\int \phi^{\ast} \phi \: \mathrm{d}\tau = 1$。将展开式(\ref{eq:8.2})代入归一化条件，得到
    \begin{equation*}
        1 = \int \phi^{\ast} \phi \: \mathrm{d}\tau = \int \sum_{k} a_k^{\ast} \psi_k^{\ast} \sum_{j} a_j \psi_j \: \mathrm{d}\tau = \sum_{k} \sum_{j} a_k^{\ast} a_j \int \psi_k^{\ast} \psi_j \: \mathrm{d}\tau = \sum_{k} \sum_{j} a_k^{\ast} a_j \delta_{kj}
    \end{equation*}
    \begin{equation}
        1 = \sum_{k} |a_k|^2
        \label{eq:8.6}
    \end{equation}
    [注意，在推导公式 (\ref{eq:8.4}) 和 (\ref{eq:8.6}) 时，我们基本上分别重复了公式 (\ref{eq:7.70}) 和 (\ref{eq:7.69}) 的推导。]

    将(\ref{eq:8.6}) 代入 (\ref{eq:8.5})就得到了变分理论(\ref{eq:8.1})的证明：
    \begin{equation}
        \int \phi^{\ast} \hat{H}\phi \:\mathrm{d}\tau \geq E_1, \quad \phi \text{已归一化}
        \label{eq:8.7}
    \end{equation}

    假设我们有一个未归一化的函数$\phi$。为了应用变分理论，我们用一个归一化常数$N$乘以$\phi$使得$N\phi$满足归一化条件。在(\ref{eq:8.7})中，我们将$\phi$替换为$N\phi$，得到
    \begin{equation}
        \left|N\right|^2 \int \phi^{\ast} \hat{H}\phi \:\mathrm{d}\tau \geq E_1
        \label{eq:8.8}
    \end{equation}
    $N$由下式导出：$\int \left(N\phi\right)^{\ast} \left(N\phi\right) \:\mathrm{d}\tau = \left|N\right|^2 \int \phi^{\ast} \phi \:\mathrm{d}\tau = 1$，因此$\left|N\right|^2 = 1/\int \phi^{\ast} \phi \:\mathrm{d}\tau$。将其代入(\ref{eq:8.8})，我们得到
    \begin{equation}
        \boxed{
            \frac{\int \phi^{\ast} \hat{H}\phi \:\mathrm{d}\tau}{\int \phi^{\ast} \phi \:\mathrm{d}\tau} \geq E_1
        }
        \label{eq:8.9}
    \end{equation}
    其中$\phi$是满足问题定解条件的任意品优函数（不必归一化）。

    函数$\phi$称为\textbf{试探变分函数}（trial variational function），(\ref{eq:8.1})中的积分[或 (\ref{eq:8.9}) 中的积分之比]称为\textbf{变分积分}（variational integral）。为了获取基态能量$E_1$的良好近似值，我们会尝试许多试探变分函数，并寻找能给出最小变分积分值的函数。由 (\ref{eq:8.1}) 可知，变分积分的值越小，我们对 $E_1$ 的近似就越好。推翻量子力学的一种方法是找到一个试探变分函数，使已知 $E_1$ 的某个系统的变分积分小于 $E_1$。

    令$\psi_1$为系统基态能量的真实波函数：
    \begin{equation}
        \hat{H}\psi_1 = E_1 \psi_1
        \label{eq:8.10}
    \end{equation}
    如果我们碰巧幸运地发现了一个等于 $\psi_1$ 的变分函数，那么在 (\ref{eq:8.1}) 中使用 (\ref{eq:8.10}) ，我们可以看到变分积分将等于 $E_1$。因此，基态波函数给出了变分积分的最小值。因此，我们预期变分积分值越小，试探变分函数就越接近真实的基态波函数。然而，事实证明，变分积分接近 $E_1$ 的速度要比试探变分函数接近 $\psi_1$ 的速度快得多，而且有可能用一个相当差的 $\phi$ 得到一个相当好的近似值 $E_1$。

    在实践中，人们通常会在试探函数 $\phi$ 中引入几个参数，然后对这些参数进行变分，从而使变分积分最小化。能否成功使用变分法，取决于能否对试探函数做出正确的选择。

    让我们来看一些变分法的例子。虽然这种方法的真正用途是针对我们不知道确切解的问题，但我们还是要考虑那些完全可解的问题，以便判断我们结果的准确性。

    \begin{examplebox}
        \textbf{例题：}为长度为 $l$ 的一维势箱中的粒子设计一个试探变分函数。
        \\

        波函数在势箱外为零，定解条件要求在$x=0$和$x=l$处$\psi=0$。变分函数$\phi$必须满足这些在边界点为零的条件。如公式 (\ref{eq:4.57}) 后所述，基态 $\psi$ 在边界点内部没有节点，因此希望 $\phi$ 也没有内部节点。具有这些性质的一个简单函数为抛物线函数
        \begin{equation}
            \phi = x\left(l-x\right), \quad 0 \leq x \leq l
            \label{eq:8.11}
        \end{equation}
        以及在势箱外，有$\phi=0$。由于我们尚未归一化$\phi$，我们使用(\ref{eq:8.9})来计算。势箱内部的哈密顿算符为$-\left(\hbar^2/2m\right)\mathrm{d}^2/\mathrm{d}x^2$。对于 (\ref{eq:8.9}) 的分子和分母，我们可以得出
        \begin{equation}
            \int \phi^{\ast} \hat{H}\phi \:\mathrm{d}\tau = -\frac{\hbar^2}{2m} \int_{0}^{l} \left(lx-x^2\right)\frac{\mathrm{d}^2}{\mathrm{d}x^2} \left(lx-x^2\right) \mathrm{d}x = \frac{\hbar^2}{m} \int_0^l \left(lx-x^2\right) \:\mathrm{d}x = \frac{\hbar^2 l^3}{6m}
            \label{eq:8.12}
        \end{equation}
        \begin{equation}
            \int \phi^{\ast} \phi \:\mathrm{d}\tau = \int_0^l x^2\left(l-x\right)^2 \:\mathrm{d}x = \frac{l^5}{30}
            \label{eq:8.13}
        \end{equation}
        将它们带入变分理论(\ref{eq:8.9})，我们得到
        \begin{equation*}
            E_1 \leq \frac{5h^2}{4\pi^2 ml^2} = 0.1266515\frac{\hbar^2}{ml^2}
        \end{equation*}
        根据(\ref{eq:2.20 energy of one-dimensional box})，$E_1$的准确值为$h^2/8ml^2=0.125h^2/8ml^2$，能量的误差约为$1.3\%$。

        由于$\int \left|\phi\right|^2 \: \mathrm{d}\tau = l^5/30$，将(\ref{eq:8.11})归一化为$\left(30/l^5\right)^{1/2} x\left(l-x\right)$。图\ref{fig:7.3}显示，该函数与真正的箱中粒子基态波函数非常相似。
        \\

        \textbf{练习：}一个单粒子一维系统的势能函数满足
        \begin{equation*}
            V = \begin{cases}
                V_0, & 0 \leq x \leq l \\
                \infty, & elsewhere
            \end{cases}
        \end{equation*}
        （其中$V_0$是常数）。

        (a)使用试探函数
        \begin{equation*}
            \phi = \begin{cases}
                \sin\left(\pi x/l\right), & 0 \leq x \leq l \\
                0, & elsewhere
            \end{cases}
        \end{equation*}
        来估算该系统的基态能量；

        (b)解释为什么(a)的结果是该系统的准确基态能量。\textit{提示：见第\ref{chap:4}章的问题之一。}（答案：(a)$V_0 + h^2/8ml^2$。）
    \end{examplebox}

    上一个例题的试探函数中没有参数。下一个例题有。

    \begin{examplebox}
        \textbf{例题：}对于一维谐振子，设计一个带有参数的变分函数，并找出参数的最佳值。估计基态能量。
        \\

        变分函数$\phi$必须平方可积，即当$x \to \pm \infty$时，$\phi \to 0$。函数$\mathrm{e}^{-x}$在$+ \infty$时满足条件，但在$-\infty$时变为无穷大。函数$\mathrm{e}^{-x^2}$在$\pm \infty$时都满足条件。然而，从量纲上看，这种做法并不令人满意，因为$\mathrm{e}$的指数必须是无量纲的。这可以从Taylor级数中看出$\mathrm{e}^z = 1 + z + z^2/2! + z^3/3! + \ldots$[式(\ref{eq:4.44})]。由于该级数中的所有项都必须有相同的量纲，那么$z$的量纲就必须为1，也就是说$\mathrm{e}^z$中的$z$必须是无量纲的。因此，我们将$\mathrm{e}^{-x^2}$替换为$\mathrm{e}^{-cx^2}$，其中$c$的量纲为长度$^{-2}$。我们将$c$作为变分参数。真实的基态$\psi$没有节点。此外，由于$V = \frac{1}{2}kx^2$是偶函数，由于奇函数在原点有节点，那么基态的$\psi$一定具有确定的宇称，也一定是偶函数。试探函数$\mathrm{e}^{-cx^2}$具有我们需要的性质：无节点，且为偶函数。

        对$\hat{H}$使用(\ref{eq:4.30})，再使用附录中的积分，有（问题8.3）
        \begin{equation*}
            \begin{aligned}
                \int \phi^{\ast} \hat{H}\phi \:\mathrm{d}\tau &= -\frac{\hbar^2}{2m} \int_{-\infty}^{\infty} \mathrm{e}^{-2cx^2} \frac{\mathrm{d}^2\mathrm{e}^{-cx^2}}{\mathrm{d}x^2} \:\mathrm{d}x + 2\pi^2\nu^2m\int_{-\infty}^{\infty} x^2 \mathrm{e}^{-2cx^2} \:\mathrm{d}x \\
                &= \frac{\hbar^2}{m} \left(\frac{\pi c}{m}\right)^{1/2} + \nu^2m\left(\frac{\pi^5}{8}\right)^{1/2} c^{-3/2}
            \end{aligned}
        \end{equation*}
        \begin{equation*}
            \int \phi^{\ast} \phi \:\mathrm{d}\tau = \int_{-\infty}^{\infty} \mathrm{e}^{-2cx^2} \:\mathrm{d}x = 2\int_{0}^{\infty} \mathrm{e}^{-2cx^2} \:\mathrm{d}x = \left(\frac{\pi}{2c}\right)^{1/2}
        \end{equation*}
        试探积分$W$为
        \begin{equation}
            W \equiv \frac{\int \phi^{\ast} \hat{H}\phi \:\mathrm{d}\tau}{\int \phi^{\ast} \phi \:\mathrm{d}\tau} = \frac{\hbar^2c}{2m} + \frac{\pi^2\nu^2m}{2c}
            \label{eq:8.14}
        \end{equation}
        现在，我们通过改变$c$来最小化$W$(\ref{eq:8.14})。$W$最小的必要条件为
        \begin{equation*}
            \frac{\mathrm{d} W}{\mathrm{d} c} = 0 = \frac{\hbar^2}{2m} - \frac{\pi^2\nu^2m}{2c^2}
        \end{equation*}
        \begin{equation}
            c = \pm \pi \nu m/\hbar
            \label{eq:8.15}
        \end{equation}
        其中，负根$c = -\pi\nu m/\hbar$应舍去，因其会导致$\phi = \mathrm{e}^{-cx^2}$不满足平方可积的要求。将$c = \pi\nu m/\hbar$代入(\ref{eq:8.14})，我们得到$W = \frac{1}{2}h\nu$。这是一维谐振子基态能量的准确值。当$c = \pi\nu m/\hbar$时，变分函数$\phi$除了未归一化以外，与谐振子基态波函数(\ref{eq:4.53})和(\ref{eq:4.31})完全一致。

        对于归一化的谐振子变分函数$\phi = \left(2c/\pi\right)^{1/4} \mathrm{e}^{-cx^2}$，若$c$的值很大，会导致$\phi$在$x=0$附近从其最大值快速下降。那么概率密度就只在$x=0$附近较大。势函数$V = \frac{1}{2}kx^2$在$x=0$附近也很小，所以较大的$c$值意味着较小的$\left\langle V \right\rangle = \left\langle \phi \middle| V \middle| \phi \right\rangle$。[注意：$\left\langle V \right\rangle$等于(\ref{eq:8.14})右侧的第二项。]然而，由于较大的$c$值使得$\phi$从其最大值快速减小，那么在$x=0$附近$\left|\mathrm{d}\phi/\mathrm{d}x\right|$的值变得很大，根据问题7.7b，大$\left|\mathrm{d}\phi/\mathrm{d}x\right|$意味着大$\left\langle T \right\rangle$[等于(\ref{eq:8.14})右侧的第一项。]$c$的最佳值可以使总和$\left\langle T \right\rangle + \left\langle V \right\rangle = W$最小化。在原子和分子中，真正的波函数是通过将电子限制在低$V$区域（靠近原子核）来最小化$\left\langle V \right\rangle$的趋势与通过允许电子概率密度在大区域内扩散来最小化$\left\langle T \right\rangle$的趋势之间的折衷。
        \\

        \textbf{练习：}考虑一个单粒子一维系统，其势函数满足
        \begin{equation*}
            V = \begin{cases}
                V = 0, & -\frac{1}{2}l \leq x \leq \frac{1}{2}l \\
                V = b\hbar^2/ml^2, & elsewhere
            \end{cases}
        \end{equation*}
        其中$b$是正常数（图 \ref{fig:2.5} 中的 $V_0 = b\hbar^2/ml^2$ 和原点发生了偏移）。

        (a)对于变分函数
        \begin{equation*}
            \phi = \begin{cases}
                \left(x-c\right)\left(x+c\right) = x^2 - c^2, & -c \leq x \leq c \\
                0, & elsewhere
            \end{cases}
        \end{equation*}
        其中变分参数$c > \frac{1}{2}l$。我们发现变分积分$W$由下式给出：
        \begin{equation*}
            W = \frac{\hbar^2}{ml^2}\left[\frac{5l^2}{4c^2} + b\left(1-\frac{15l}{16c} + \frac{5l^3}{32c^3} - \frac{3l^5}{256c^5}\right)\right]
        \end{equation*}
        在同一幅图上绘制$\phi$和$V$的图象。求使 $W$ 最小的 $c$ 值所满足的方程。

        (b)当$V_0 = 20\hbar^2/ml^2$时，求出$c$的最佳值和$W$的值，将其与基态能量真实值$2.814\hbar^2/ml^2$进行比较（问题4.31c）。（\textit{提示：}可以使用Excel表格求解器或可编程计算器来计算$c/l$的值。）

        （\textit{答案：}(a)$48t^4-24t^2-128t^3/b+3=0$，其中$t \equiv c/l$；(b)$c = 0.6715l$，$W = 3.454\hbar^2/ml^2$。）
    \end{examplebox}

\section{变分法的推广}
\label{sec:8.2 Extension of the Variational Method}
    上一节介绍的变分法只提供了基态能量和波函数的信息。现在我们讨论将变分法推广到激发态。（另请参见第 \ref{sec:8.5 Linear Variational Functions} 节）。

    考虑一下我们可以如何推广变分法，来估算第一激发态的能量。根据能量从低到高：
    \begin{equation*}
        E_1 \leq E_2 \leq E_3 \leq \ldots
    \end{equation*}
    我们将系统的状态标号为$1,2,3,\ldots$。我们已经证明：对于一个已归一化的变分函数$\phi$，有[式(\ref{eq:8.4})和(\ref{eq:8.6})]
    \begin{equation*}
        \int \phi^{\ast} \hat{H}\phi \:\mathrm{d}\tau = \sum_{k=1}^{\infty} |a_k|^2 E_k \quad \text{和} \quad \int \phi^{\ast} \phi \:\mathrm{d}\tau = \sum_{k=1}^{\infty} |a_k|^2 = 1
    \end{equation*}
    其中的$a_k$是展开式$\phi = \sum_{k} a_k \psi_k$中的系数[式(\ref{eq:8.2})]。我们有$a_k = \left\langle \psi_k \middle| \phi \right\rangle$[式(\ref{eq:7.40})]。让我们只讨论与真实基态波函数$\psi$正交的归一化函数$\phi$。那么$a_1 = \left\langle \psi_1 \middle| \phi \right\rangle = 0$，因此
    \begin{equation}
        \int \phi^{\ast} \hat{H}\phi \:\mathrm{d}\tau = \sum_{k=2}^{\infty} |a_k|^2 E_k \quad \text{和} \quad \int \phi^{\ast} \phi \:\mathrm{d}\tau = \sum_{k=2}^{\infty} |a_k|^2 = 1
        \label{eq:8.16}
    \end{equation}
    对于$k \geq 2$，我们有$E_k \geq E_2$和$\left|a_k\right|^2E_k \geq \left|a_k\right|^2E_2$。因此，
    \begin{equation}
        \sum_{k=2}^{\infty} \left|a_k\right|^2 E_k \geq \sum_{k=2}^{\infty} \left|a_k\right|^2 E_2 = E_2 \sum_{k=2}^{\infty} \left|a_k\right|^2 = E_2
        \label{eq:8.17}
    \end{equation}
    将(\ref{eq:8.16})和(\ref{eq:8.17})相结合，我们得到了所需的结果：
    \begin{equation}
        \int \phi^{\ast} \hat{H}\phi \:\mathrm{d}\tau \geq E_2, \quad \text{若} \int \psi^{\ast} \phi \:\mathrm{d}\tau = 0 \quad \text{且} \int \phi^{\ast} \phi \:\mathrm{d}\tau = 1
        \label{eq:8.18}
    \end{equation}
    通过不等式 (\ref{eq:8.18}) 我们可以得到第一激发态的能量 $E_2$ 的上限。然而，限制条件$\left\langle \psi_1 \middle| \phi \right\rangle = 0$使得这种方法在应用上会很麻烦。

    对于特定的系统，尽管我们不知道真实基态波函数，但确定$\left\langle \psi_1 \middle| \phi \right\rangle = 0$是可能的。$V$ 是 $x$ 的偶函数的一维问题就是一个例子。在这种情况下，基态波函数总是偶函数，而第一激发态波函数是奇函数。（所有波函数必须具有确定的宇称。基态波函数是无节点的，由于奇函数在原点消失，所以基态波函数必须是偶函数。第一个激发态波函数有一个节点，一定是奇函数。）因此，对于奇函数，$\left\langle \psi_1 \middle| \phi \right\rangle = 0$一定成立，偶函数$\psi_1$乘以一个奇函数$\phi$得到一个奇被积函数，从$-\infty$到$+\infty$的积分为零。

    另一个例子是在中心场中运动的粒子（第 \ref{sec:6.1 The One-Particle Central Force Problem} 节）。势能的形式可能使我们无法求解本征函数中的径向因子 $R(r)$。然而，其中的角度因子 $\psi$ 是球谐函数[式 (\ref{eq:6.16}) ]，而不同 $l$ 值的球谐函数是正交的。因此，我们可以利用试探函数中的因子$Y_l^m$，求出任意给定角动量$l$的最低态能量上限。这一结果取决于将 (\ref{eq:8.18}) 推广到更高的激发态：
    \begin{equation}
        \frac{\int \phi^{\ast} \hat{H}\phi \:\mathrm{d}\tau}{\int \phi^{\ast} \phi \:\mathrm{d}\tau} \geq E_{k+1}, \quad \text{若} \int \psi_1^{\ast} \phi \: \mathrm{d}\tau = \int \psi_2^{\ast} \phi \:\mathrm{d}\tau = \cdots = \int \psi_k^{\ast} \phi \:\mathrm{d}\tau = 0
        \label{eq:8.19}
    \end{equation}

\section{行列式}
\label{sec:8.3 Determinants}
    第 \ref{sec:8.5 Linear Variational Functions} 节讨论了一种变分函数，它产生了一个涉及行列式的方程。因此，我们现在讨论行列式。
     
    \textbf{行列式}（Determinant）是一个包含 $n^2$ 个量（称为\textbf{元素}（elements））的正方形数组；行列式的值是根据其元素计算出来的，计算方法稍后给出。$n$称为行列式的\textbf{阶}（order）。使用$a_{ij}$来代表一个典型元素，我们有$n$阶行列式
    \begin{equation}
            \det\left(a_{ij}\right) = \begin{vmatrix}
                a_{11} & a_{12} & a_{13} & \cdots & a_{1n} \\
                a_{21} & a_{22} & a_{23} & \cdots & a_{2n} \\
                \vdots & \vdots & \vdots & \ddots & \vdots \\
                a_{n1} & a_{n2} & a_{n3} & \cdots & a_{nn}
            \end{vmatrix}
            \label{eq:8.20}
    \end{equation}
    (\ref{eq:8.20})中的竖线与绝对值无关。在考虑$n$阶行列式值的定义方法之前，我们先考虑一阶、二阶和三阶行列式。

    一阶行列式有一个元素，其值就是该元素本身。因此，
    \begin{equation}
        \left| a_{11} \right| = a_{11}
        \label{eq:8.21}
    \end{equation}
    其中的竖线表示行列式而不是绝对值。

    二阶行列式有四个元素，其值定义为
    \begin{equation}
        \boxed{
            \begin{vmatrix}
                a_{11} & a_{12} \\
                a_{21} & a_{22}
            \end{vmatrix} = a_{11}a_{22} - a_{12}a_{21}
        }
        \label{eq:8.22}
    \end{equation}
    三阶行列式的值定义为
    \begin{equation}
            \boxed{
            \begin{vmatrix}
                a_{11} & a_{12} & a_{13} \\
                a_{21} & a_{22} & a_{23} \\
                a_{31} & a_{32} & a_{33}
            \end{vmatrix} = a_{11}\begin{vmatrix}
                a_{22} & a_{23} \\
                a_{32} & a_{33}
            \end{vmatrix} - a_{12}\begin{vmatrix}
                a_{21} & a_{23} \\
                a_{31} & a_{33}
            \end{vmatrix} + a_{13}\begin{vmatrix}
                a_{21} & a_{22} \\
                a_{31} & a_{32}
            \end{vmatrix}
        }
        \label{eq:8.23}
    \end{equation}
    \begin{equation}
        \begin{aligned}
            = & a_{11}a_{22}a_{33} - a_{11}a_{23}a_{32} - a_{12}a_{21}a_{33} + a_{12}a_{23}a_{31} \\ 
            & + a_{13}a_{21}a_{32} - a_{13}a_{22}a_{31}
        \end{aligned}
        \label{eq:8.24}
    \end{equation}
    三阶行列式的计算方法是：用正负号交替写下第一行的元素，然后将每个元素乘以某个二阶行列式；在三阶行列式中划掉某个元素出现的行和列，就能找到与该元素相乘的二阶行列式。将$n$阶行列式的第$i$行和第$j$列删去后得到的$\left(n-1\right)$阶行列式称为元素$a_{ij}$的\textbf{余子式}（minor）。我们再定义$a_{ij}$的\textbf{代数余子式}（cofactor）为$a_{ij}$的余子式乘以$(-1)^{i+j}$。因此，(\ref{eq:8.23}) 说明三阶行列式的计算方法是：将顶行的每个元素乘以它的代数余子式，然后将三个乘积相加。[注意：式(\ref{eq:8.22})通过代数余子式符合该方法。因为$a_{11}$的代数余子式为$a_{22}$，$a_{12}$的代数余子式为$-a_{21}$。]一个数值的例子如下
    \begin{equation*}
        \begin{aligned}
            \begin{vmatrix}
                5 & 10 & 2 \\
                0.1 & 3 & 1 \\
                0 & 4 & 4
            \end{vmatrix} &= 5\begin{vmatrix}
                3 & 1 \\
                4 & 4
            \end{vmatrix} - 10\begin{vmatrix}
                0.1 & 1 \\
                0 & 4
            \end{vmatrix} + 2\begin{vmatrix}
                0.1 & 3 \\
                0 & 4
            \end{vmatrix} \\
            &= 5\left(8\right) - 10\left(0.4\right) + 2\left(0.4\right) = 36.8
            \end{aligned}
    \end{equation*}

    我们将$a_{ij}$的余子式记为$M_{ij}$，代数余子式记为$C_{ij}$，则
    \begin{equation}
        c_{ij} = \left(-1\right)^{i+j}M_{ij}
        \label{eq:8.25}
    \end{equation}
    则三阶行列式的展开式(\ref{eq:8.23})可以写为
    \begin{equation}
        \det\left(a_{ij}\right) = \begin{vmatrix}
            a_{11} & a_{12} & a_{13} \\
            a_{21} & a_{22} & a_{23} \\
            a_{31} & a_{32} & a_{33}
        \end{vmatrix} = a_{11}C_{11} + a_{12}C_{12} + a_{13}C_{13}
        \label{eq:8.26}
    \end{equation}
    三阶行列式可以用任意一行的元素和相应的代数余子式展开。例如，利用第二行展开三阶行列式，我们可以得出
    \begin{equation}
        \det\left(a_{ij}\right) = a_{21}C_{21} + a_{22}C_{22} + a_{23}C_{23}
        \label{eq:8.27}
    \end{equation}
    \begin{equation}
        \det\left(a_{ij}\right) = -a_{21}\begin{vmatrix}
            a_{11} & a_{13} \\
            a_{31} & a_{33}
        \end{vmatrix} + a_{22}\begin{vmatrix}
            a_{11} & a_{13} \\
            a_{31} & a_{33}
        \end{vmatrix} - a_{23}\begin{vmatrix}
            a_{11} & a_{12} \\
            a_{31} & a_{32}
        \end{vmatrix}
        \label{eq:8.28}
    \end{equation}
    二阶行列式的展开式表明 (\ref{eq:8.28}) 等于 (\ref{eq:8.24})。我们也可以使用任意一列的元素和相应的代数余子式来展开行列式，这一点很容易得到验证。因此，对于三阶行列式，我们可以写成
    \begin{equation*}
        \det\left(a_{ij}\right) = a_{k1}C_{k1} + a_{k2}C_{k2} + a_{k3}C_{k3} = \sum_{l=1}^{3} a_{kl}C_{kl}, \quad k = 1,2,3
    \end{equation*}
    \begin{equation*}
        \det\left(a_{ij}\right) = a_{1k}C_{1k} + a_{2k}C_{2k} + a_{3k}C_{3k} = \sum_{l=1}^{3} a_{lk}C_{lk}, \quad k = 1,2,3
    \end{equation*}
    第一个展开式按某一行展开，第二个则按某一列展开。

    我们通过类似的行（或列）展开来定义高阶行列式。对于 $n$ 阶行列式，
    \begin{equation}
        \det\left(a_{ij}\right) = \sum_{l=1}^{n} a_{kl}C_{kl} = \sum_{l=1}^{n} a_{lk}C_{lk}, \quad k = 1,2,\ldots,n
        \label{eq:8.29}
    \end{equation}

    一些有关行列式的性质如下所述（证明见\textit{Sokolnikoff and Redheffer}, pp. 702–707）：
        \begin{enumerate}
            \item 如果行列式某行（或列）的每个元素都为零，则行列式的值为零。
            \item 交换行列式的两行（或两列）会使行列式的值改变符号。
            \item 如果行列式的两行（或两列）相同，则该行列式的值为零。
            \item 如果将行列式的一行（或一列）乘以一个常数 $k$，则该行列式的值也乘以 $k$。
            \item 如在一行的每个元素上加上另一行相应元素的相同常数倍数，行列式的值不变。这个定理也适用于将一列的倍数加到另一列。
            \item 互换所有相应的行和列，行列式的值保持不变。（这种互换意味着第一列变为第一行，第二列变为第二行，等等）
        \end{enumerate}
    
    \begin{examplebox}
        \textbf{例题：}使用性质5计算
        \begin{equation}
            B = \begin{vmatrix}
                1 & 2 & 3 & 4 \\
                4 & 1 & 2 & 3 \\
                3 & 4 & 1 & 2 \\
                2 & 3 & 4 & 1
            \end{vmatrix}
            \label{eq:8.30}
        \end{equation}
        \\

        将第一行的元素乘以$-2$并加到第四行，将其变为$2+\left(-2\right)1=0$，$3+\left(-2\right)2= -1$，$4+\left(-2\right)3 = -2$，$1+\left(-2\right)4 = -7$。同理，将第一行乘以$-3$并加到第三行，乘以$-4$并加到第二行。这样，(\ref{eq:8.30})变为
        \begin{equation}
            B = \begin{vmatrix}
                1 & 2 & 3 & 4 \\
                0 & -7 & -10 & -13 \\
                0 & -2 & -8 & -10 \\
                0 & -1 & -2 & -7
            \end{vmatrix} = 1\begin{vmatrix}
                -7 & -10 & -13 \\
                -2 & -8 & -10 \\
                -1 & -2 & -7
            \end{vmatrix}
            \label{eq:8.31}
        \end{equation}
        其中，我们将$B$按第一列展开。第二行减去第三行的两倍，第一行再减去第三行的七倍，得出
        \begin{equation}
            B = \begin{vmatrix}
                0 & 4 & 36 \\
                0 & -4 & 4 \\
                -1 & -2 & -7
            \end{vmatrix} = \left(-1\right)\begin{vmatrix}
                4 & 36 \\
                -4 & 4
            \end{vmatrix} = -\left(16 + 144\right) = -160
            \label{eq:8.32}
        \end{equation}
    \end{examplebox}

    行列式中从左上方到右下方的对角线就是\textbf{主对角线}（principal diagonal）。\textbf{对角行列式}（diagonal determinant）是指除主对角线上的元素外，其他元素均为零的行列式。对于一个对角行列式，
    \begin{equation}
        \begin{aligned}
            \begin{vmatrix}
                a_{11} & 0 & 0 & \cdots & 0 \\
                0 & a_{22} & 0 & \cdots & 0 \\
                0 & 0 & a_{33} & \cdots & 0 \\
                \vdots & \vdots & \vdots & \ddots & \vdots \\
                0 & 0 & 0 & \cdots & a_{nn}
            \end{vmatrix} &= a_{11}\begin{vmatrix}
                a_{22} & 0 & \cdots & 0 \\
                0 & a_{33} & \cdots & 0 \\
                \vdots & \vdots & \ddots & \vdots \\
                0 & 0 & \cdots & a_{nn}
            \end{vmatrix} = a_{11}a_{22}\begin{vmatrix}
                a_{33} & 0 & \cdots & 0 \\
                0 & a_{44} & \cdots & 0 \\
                \vdots & \vdots & \ddots & \vdots \\
                0 & 0 & \cdots & a_{nn}
            \end{vmatrix} \\
            &= \cdots = a_{11}a_{22}a_{33}\cdots a_{nn}
        \end{aligned}
    \label{eq:8.33}
    \end{equation}
    \textit{对角行列式的值等于其对角元素的乘积。}

    一个行列式的唯一非零元素出现在以主对角线为中心的方形块中，这个行列式就是\textbf{块对角形式}（block diagonal form）。 如果我们把每个正方形块看作行列式，那么块对角行列式就等于块的乘积。例如
    \begin{equation}
        \begin{vmatrix}
            a & b & 0 & 0 & 0 & 0 \\
            c & d & 0 & 0 & 0 & 0 \\
            0 & 0 & e & 0 & 0 & 0 \\
            0 & 0 & 0 & f & g & h \\
            0 & 0 & 0 & i & j & k \\
            0 & 0 & 0 & l & m & n
        \end{vmatrix} = \begin{vmatrix}
            a & b \\
            c & d
        \end{vmatrix} \left(e\right)\begin{vmatrix}
            f & g & h \\
            i & j & k \\
            l & m & n
        \end{vmatrix}
        \label{eq:8.34}
    \end{equation}
    虚线（图中未画出）勾勒出区块的轮廓。用顶行元素展开左边的行列式，再用它们的顶行展开后面的几个行列式，就可以很容易地证明方程 (\ref{eq:8.34}) (问题 8.21)。

\section{联立线性方程组}
\label{sec:8.4 Simultaneous Linear Equations}
    要处理下一节所要讨论的变分函数，我们需要知道联立线性方程组。

    考虑以下关于$n$个未知数的$n$个线性方程系统：
    \begin{equation}
        \begin{aligned}
            a_{11}x_1 + a_{12}x_2 + \cdots + a_{1n}x_n &= b_1 \\
            a_{21}x_1 + a_{22}x_2 + \cdots + a_{2n}x_n &= b_2 \\
            &\vdots \\
            a_{n1}x_1 + a_{n2}x_2 + \cdots + a_{nn}x_n &= b_n
        \end{aligned}
        \label{eq:8.35}
    \end{equation}
    其中的$a$和$b$是已知常数，$x_1,x_2,\ldots,x_n$是未知数。如果至少有一个$b$值为非零，我们得到了一个\textbf{非齐次}（inhomogeneous）方程组。这样的系统可以用Cramer法则（Cramer's rule）求解。（Cramer法则的证明见\textit{Sokolnikoff and Redheffer}, pp. 708。）令$\det\left(a_{ij}\right)$表示(\ref{eq:8.35})中未知数的系数行列式，由Cramer法则，$x_k \: \left(k = 1,2,\ldots,n\right)$的值由下式给出：
    \begin{equation}
        x_k = \frac{
            \begin{vmatrix}
                a_{11} & a_{12} & \cdots & a_{1,k-1} & b_1 & a_{1,k+1} & \cdots & a_{1n} \\
                a_{21} & a_{22} & \cdots & a_{2,k-1} & b_2 & a_{2,k+1} & \cdots & a_{2n} \\
                \vdots & \vdots & \ddots & \vdots & \vdots & \vdots & \ddots & \vdots \\
                a_{n1} & a_{n2} & \cdots & a_{n,k-1} & b_n & a_{n,k+1} & \cdots & a_{nn}
            \end{vmatrix}
        }{\det\left(a_{ij}\right)}, \quad k = 1,2,\ldots,n
        \label{eq:8.36}
    \end{equation}
    其中的$\det\left(a_{ij}\right)$由(\ref{eq:8.20})给出，分子中的行列式通过将$\det\left(a_{ij}\right)$的第$k$列替换为$b_1,b_2,\ldots,b_n$来获得。虽然Cramer法则具有理论意义，但不应在数值计算中使用，因为连续消除未知数的效率更高。

    一种广泛使用的连续消元法称为\textbf{高斯消元法}（Gaussian elimination），其过程如下：将第一个方程的两边同除以$x_1$的系数$a_{11}$，使得$x_1$的系数变为1。然后用第二个方程减去第一个方程的$a_{21}$倍，用第三个方程减去第一个方程的$a_{31}$倍，以此类推，直到用第$n$个方程减去第一个方程的$a_{n1}$倍。这就在所有方程中消去了$x_1$（除了第一个方程）。接下来，将第二个方程的两边同除以$x_2$的系数$a_{22}$，使得$x_2$的系数变为1。然后用第三，第四$\cdots$，第$n$个方程减去第二个方程的适当倍数，这就消去了$x_2$（除了第一和第二个方程）。重复这个过程，直到第$n$个方程只包含$x_n$，第$n-1$个方程只包含$x_{n-1}$和$x_n$，等等。通过第$n$个方程解得$x_n$，然后将其代入第$n-1$个方程中解得$x_{n-1}$，将$x_{n-1}$和$x_n$代入第$n-2$个方程中解得$x_{n-2}$，以此类推，直到解出所有未知数。如果在任何阶段，我们想要除以的系数恰好为零，那么零系数的等式就会与后来在所需位置上具有非零系数的等式交换。（高斯消元法也是一种有效的行列式求值方法，见问题 8.25。）

    一种相关的方法是\textbf{高斯-若尔当消元法}（Gauss-Jordan elimination），其过程与高斯消元法类似，但与高斯消元法将$x_2$从方程$3,4,\ldots,n$中消去不同，通过减去第二个方程的适当倍数，我们将$x_2$从方程$1,3,4,\ldots,n$中消去；与将$x_3$从方程$4,5,\ldots,n$中消去不同，我们将$x_3$从方程$1,2,4,5,\ldots,n$中消去，以此类推。最后，方程1只包含$x_1$，方程2只包含$x_2$，方程$n$只包含$x_n$。高斯-若尔当消元法比高斯消元法需要更多的计算量。

    若(\ref{eq:8.35})中所有的$b$都为零，我们得到了一个\textbf{齐次线性方程组}（homogeneous linear equations）：
    \begin{equation}
        \begin{aligned}
            a_{11}x_1 + a_{12}x_2 + \cdots + a_{1n}x_n &= 0 \\
            a_{21}x_1 + a_{22}x_2 + \cdots + a_{2n}x_n &= 0 \\
            &\vdots \\
            a_{n1}x_1 + a_{n2}x_2 + \cdots + a_{nn}x_n &= 0
        \end{aligned}
        \label{eq:8.37}
    \end{equation}
    (\ref{eq:8.37})的一组显而易见的解为$x_1=x_2 = \ldots = x_n=0$，称为\textbf{平凡解}（trivial solution）。若(\ref{eq:8.37})的系数行列式$\det\left(a_{ij}\right)$不为零，我们可以使用Cramer法则(\ref{eq:8.36})来求解未知数，并发现$x_k=0, \: k=1,2,\ldots,n$，因为 (\ref{eq:8.36}) 分子中的行列式有一列所有元素都为零。因此，当$\det\left(a_{ij}\right) \neq 0$时，唯一的解就是平凡解，这没有任何意义。要使关于 $n$ 个未知数的，由$n$个齐次方程组成的线性方程组有一组非平凡解，系数的行列式必须为零。而且，这个条件足以确保非平凡解的存在。因此，我们得到了极为重要的定理：
    \begin{center}
        \parbox{0.8\textwidth}{
            \textit{当且仅当系数行列式为零时，关于 $n$ 个未知数的，由$n$个齐次方程组成的线性方程组有一组非平凡解。}
        }
    \end{center}

    假设$\det\left(a_{ij}\right) = 0$，则(\ref{eq:8.37})有一组非平凡解。我们如何找到它呢？由于$\det\left(a_{ij}\right) = 0$，Cramer法则(\ref{eq:8.36})给出$x_k = 0/0, \: k = 1,2,\ldots,n$，这没有任何意义。因此，Cramer法则并不能立即起到帮助作用。注意到，若$x_1=d_1,x_2=d_2,\ldots,x_n=d_n$是(\ref{eq:8.37})的一组解，那么$x_1=cd_1,x_2=cd_2,\ldots,x_n=cd_n$也是(\ref{eq:8.37})的一组解，其中$c$是任意常数。这一点很容易看出，因为
    \begin{equation*}
        a_{11}cd_1 + a_{12}cd_2 + \cdots + a_{1n}cd_n = c\left(a_{11}d_1 + a_{12}d_2 + \cdots + a_{1n}d_n\right) = c\cdot 0 = 0
    \end{equation*}
    以此类推。因此，线性齐次方程组的解将包含一个任意常数，我们无法为每一个未知数找到一个唯一的值。为了求解(\ref{eq:8.37})，我们给任意一个未知数赋以任意的值，如$x_n=c$，其中$c$是任意常数。确定了$x_n$的值之后，我们将(\ref{eq:8.37})中每个方程的最后一项移到右边，得到
    \begin{equation}
        \begin{aligned}
            a_{11}x_1 + a_{12}x_2 + \cdots + a_{1,n-1}x_{n-1} &= -a_{1n}c \\
            a_{21}x_1 + a_{22}x_2 + \cdots + a_{2,n-1}x_{n-1} &= -a_{2n}c \\
            &\vdots \\
            a_{n-1,1}x_1 + a_{n-1,2}x_2 + \cdots + a_{n-1,n-1}x_{n-1} &= -a_{n-1,n}c \\
            a_{n1}x_1 + a_{n2}x_2 + \cdots + a_{n,n-1}x_{n-1} &= -a_{nn}c
        \end{aligned}
        \label{eq:8.38}
    \end{equation}
    我们现在有$n-1$个未知数和$n$个方程，这比我们需要的多了一个。因此，我们删去(\ref{eq:8.38})中的任意一个方程，以最后一个为例。这就得到了关于$n-1$个未知数的，由$n-1$个\textit{非}齐次方程组成的线性方程组。然后就可以用Cramer法则(\ref{eq:8.36})来求解未知数$x_1,x_2,\ldots,x_{n-1}$。因为(\ref{eq:8.38})中，右侧的常数都包含因子$c$，所以根据\ref{sec:8.3 Determinants}节的定理4，$x_1,x_2,\ldots,x_{n-1}$的值也包含因子$c$。因此，(\ref{eq:8.37})的解可以写成
    \begin{equation}
        x_1 = ce_1, \quad x_2 = ce_2, \quad \ldots, \quad x_{n-1} = ce_{n-1}, \quad x_n = c
        \label{eq:8.39}
    \end{equation}
    其中$c$是任意常数，$e_1,e_2,\ldots,e_{n-1}$是数字。

    \begin{examplebox}
        \textbf{例题：}求解：
        \begin{equation*}
            \begin{aligned}
                3x_1 + 4x_2 + x_3 &= 0 \\
                x_1 + 3x_2 - 2x_3 &= 0 \\
                x_1 - 2x_2 + 5x_3 &= 0
            \end{aligned}
        \end{equation*}

        这是线性齐次方程组，我们先计算系数行列式。得出（见练习）
        \begin{equation*}
            \begin{vmatrix}
                3 & 4 & 1 \\
                1 & 3 & -2 \\
                1 & -2 & 5
            \end{vmatrix} = 0
        \end{equation*}
        因此，存在一组非平凡解。我们给$x_3$赋值$c$，删去第三个方程，得到
        \begin{equation*}
            \begin{aligned}
                3x_1 + 4x_2 &= -c \\
                x_1 + 3x_2 &= 2c
            \end{aligned}
        \end{equation*}
        第一个方程减去第二个方程的三倍，得到$-5x_2 = -7c$，因此$x_2 = \frac{7}{5}c$。带入$x_1+3x_2 = 2c$，得到$x_1 +\frac{21}{5}c = 2c$，因此$x_1 = -\frac{11}{5}c$。因此，通解为$x_1 = -\frac{11}{5}c, \: x_2 = \frac{7}{5}c, \: x_3 = c$。对于那些对分式过敏的人（无意冒犯，译者注），我们定义一个新的任意常数$s \equiv \frac{1}{5}c$，则$x_1 = -11s, \: x_2 = 7s, \: x_3 = 5s$。
        \\

        \textbf{练习：}

        (a)证明本例中系数行列式的值为零；

        (b)证明：将第二个方程乘以某个常数并与第一个方程相加，就可以得到本例中的第三个方程。
    \end{examplebox}

    如果 $n-1$ 个未知数中的 $n-1$ 个非均质方程组的行列式 [(\ref{eq:8.38})，最后一个方程省略] 恰好为零，则上述步骤将失效。这样Cramer法则的分母中就有了一个零，也就失去了作用。为了解决这个问题，我们可以先将任意值赋值给另一个未知数，而不是 $x_n$。我们还可以尝试删去 (\ref{eq:8.38}) 的其他方程，而不是最后一个方程。我们要寻找的是一个不会消失的 $n-1$ 阶行列式，它由系统 (\ref{eq:8.37}) 的系数行列式通过删除一行和一列而形成。如果存在这样的行列式，那么按照给出的步骤，正确选择要舍弃的方程，正确选择要赋值的未知数，我们就可以求解方程组，并得到形式为 (\ref{eq:8.39}) 的解。如果不存在这样的行列式，我们就必须给两个未知数任意赋值，并尝试从这里开始求解。因此，(\ref{eq:8.37}) 的解可能包含两个（甚至更多）任意常数。

    求解线性齐次方程组的有效方法是对方程进行高斯-若尔当消元。如果只存在平凡解，最终得到的方程组将是 $x_1=0,x_2=0,\ldots,x_n=0$。如果存在非平凡解，则至少有一个方程会简化为 $0=0$ 的形式；如果得到 $m$ 个 $0=0$ 形式的方程，我们就为其中的 $m$ 个未知数指定任意常数，并用这 $m$ 个未知数来表示其余的未知数。

    \begin{examplebox}
        \textbf{例题：}使用高斯-若尔当消元法求解上例中的方程组。

        在使用高斯消元法或高斯-若尔当消元法求解包含$n$个齐次或非齐次方程的方程组时，通过略去变量$x_1,\ldots,x_n$，只写出包含第$n$行和第$\left(n+1\right)$列系数和常数（包含任意零系数）组成的阵列，我们可以省去不必要的过程；然后，我们对每一行的数字进行运算，就好像这一行就是它所代表的等式一样，从而产生下一个阵列。

        为了开始除法消元，我们交换第一个方程和第二个方程，从而以 $a_{11} = 1$ 开始。分离系数并进行高斯-若尔当消元，我们得到
        \begin{equation*}
            \begin{matrix}
                1 & 3 & -2 & 0 \\
                3 & 4 & 1 & 0 \\
                1 & -2 & 5 & 0
            \end{matrix} \quad \rightarrow \quad 
            \begin{matrix}
                1 & 3 & -2 & 0 \\
                0 & -5 & 7 & 0 \\
                0 & -5 & 7 & 0
            \end{matrix} \quad \rightarrow \quad 
            \begin{matrix}
                1 & 3 & -2 & 0 \\
                0 & -1 & -\frac{7}{5} & 0 \\
                0 & 0 & 0 & 0
            \end{matrix} \quad \rightarrow \quad
            \begin{matrix}
                1 & 0 & \frac{11}{5} & 0 \\
                0 & 1 & -\frac{7}{5} & 0 \\
                0 & 0 & 0 & 0
            \end{matrix}
        \end{equation*}
        第一个阵列是原方程组，但第一个和第二个方程互换。为了将$x_1$从第二和第三个方程中消去，我们将第二个方程乘以$-3$并加到第二个方程上，将第一个方程乘以$-1$并加到第三个方程上，这就得到了第二个阵列。对第二行除以5得到第三个阵列。为了将$x_2$从第一和第三个方程中消去，我们将第二个方程乘以$-3$并加到第一个方程上，将第二个方程乘以$-7/5$并加到第三个方程上，得到第四个阵列。由于第四个阵列中$x_3$的系数为零，我们不能使用第三个方程从第一和第二个方程中消去$x_3$（这原本是高斯-若尔当消元法的下一步）。因此，我们将$0=0$的第三个方程删去，设$x_3=k$，其中$k$是任意常数。最后一个阵列中的第一和第二个方程有$x_1 + \frac{11}{5}x_3 = 0$和$x_2 - \frac{7}{5}x_3 = 0$，或$x_1 = -\frac{11}{5}x_3$和$x_2 = \frac{7}{5}x_3$。因此，通解为$x_1 = -\frac{11}{5}k, \: x_2 = \frac{7}{5}k, \: x_3 = k$。
    \end{examplebox}

\section{线性变分函数}
\label{sec:8.5 Linear Variational Functions}
    在分子研究中被广泛使用的一种变分函数为线性变分函数。\textbf{线性变分函数}（linear variational function）是$n$个线性无关函数$f_1,f_2,\ldots,f_n$的线性组合：
    \begin{equation}
        \phi = c_1f_1 + c_2f_2 + \cdots + c_nf_n = \sum_{j=1}^{n}c_jf_j
        \label{eq:8.40}
    \end{equation}
    其中$\phi$是试探变分函数，系数$c_j$是待确定使得变分积分最小的参数。函数$f_j$[称为\textbf{基函数}（basis functions）]必须满足问题的定解条件。我们将只讨论实函数$\phi$，则$c_j$和$f_j$分别是实数和实函数。在(\ref{eq:8.40})中，$f_j$是已知函数。

    我们现在应用变分理论(\ref{eq:8.9})。对于线性变分函数，我们有
    \begin{equation}
        \int \phi^{\ast} \phi \: \mathrm{d}\tau = \int \sum_{j=1}^{n}c_jf_j \sum_{k=1}^{n}c_kf_k\:\mathrm{d}\tau = \sum_{j=1}^{n}\sum_{k=1}^{n}c_jc_k\int f_jf_k \: \mathrm{d}\tau = \sum_{j=1}^{n}\sum_{k=1}^{n}c_jc_kS_{jk}
        \label{eq:8.41}
    \end{equation}
    我们定义\textbf{重叠积分}（overlap integral）$S_{jk}$为
    \begin{equation}
        \boxed{
            S_{jk} \equiv \int f_j^{\ast}f_k \: \mathrm{d}\tau
        }
        \label{eq:8.42}
    \end{equation}
    注意：$S_{jk}$不一定等于$\delta_{jk}$，因此，没有理由认为函数组$f_j$是相互正交的。它们也不一定是任何一个算符的本征函数。(\ref{eq:8.9})的分母为
    \begin{equation*}
        \begin{aligned}
            \int \phi^{\ast} \hat{H} \phi\:\mathrm{d}\tau &= \int \sum_{j=1}^{n}c_jf_j\hat{H}c_kf_k\:\mathrm{d}\tau \\
            &= \sum_{j=1}^{n}\sum_{k=1}^{n}c_jc_k\int f_j\hat{H}f_k\:\mathrm{d}\tau = \sum_{j=1}^{n}\sum_{k=1}^{n}c_jc_kH_{jk}
        \end{aligned}
    \end{equation*}
    其中，我们定义$H_{jk}$为
    \begin{equation}
        \boxed{
            H_{jk} \equiv \int f_j^{\ast}\hat{H}f_k \: \mathrm{d}\tau
        }
        \label{eq:8.43}
    \end{equation}

    那么变分积分$W$为
    \begin{equation}
        W \equiv \frac{\int \phi^{\ast} \hat{H} \phi\:\mathrm{d}\tau}{\int \phi^{\ast} \phi\:\mathrm{d}\tau} = \frac{\sum_{j=1}^{n}\sum_{k=1}^{n}c_jc_kH_{jk}}{\sum_{j=1}^{n}\sum_{k=1}^{n}c_jc_kS_{jk}}
        \label{eq:8.44}
    \end{equation}
    \begin{equation}
        W\sum_{j=1}^{n}\sum_{k=1}^{n}c_jc_kS_{jk} = \sum_{j=1}^{n}\sum_{k=1}^{n}c_jc_kH_{jk}
        \label{eq:8.45}
    \end{equation}
    现在我们将 $W$ 最小化，以尽可能接近 $E_1$($W \geq E_1$)。变分积分$W$是$n$个独立变量$c_1,c_2,\ldots,c_n$的函数：
    \begin{equation*}
        W = W\left(c_1,c_2,\ldots,c_n\right)
    \end{equation*}
    多个变量的函数 $W$ 的最小值的一个必要条件是：在最小值处，函数 $W$ 对每个变量的偏导数必须为零：
    \begin{equation}
        \frac{\partial W}{\partial c_i} = 0, \quad i = 1,2,\ldots,n
        \label{eq:8.46}
    \end{equation}
    我们现在将(\ref{eq:8.45})对每个变量$c_i$求偏导数，获得$n$个方程
    \begin{equation}
        \frac{\partial W}{\partial c_i}\sum_{j=1}^{n}\sum_{k=1}^{n}c_jc_kS_{jk} + W\frac{\partial}{\partial c_i}\sum_{j=1}^{n}\sum_{k=1}^{n}c_jc_kS_{jk} = \frac{\partial}{\partial c_i}\sum_{j=1}^{n}\sum_{k=1}^{n}c_jc_kH_{jk}, \quad i = 1,2,\ldots,n
        \label{eq:8.47}
    \end{equation}
    那么
    \begin{equation*}
        \frac{\partial}{\partial c_i}\sum_{j=1}^{n}\sum_{k=1}^{n}c_jc_kS_{jk} = \sum_{j=1}^{n}\sum_{k=1}^{n}\left[\frac{\partial}{\partial c_i}\left(c_jc_k\right)\right]S_{jk} = \sum_{j=1}^{n}\sum_{k=1}^{n}\left(c_k\frac{\partial c_j}{\partial c_i} + c_j\frac{\partial c_k}{\partial c_i}\right)S_{jk}
    \end{equation*}
    $c_j$是独立变量，因此
    \begin{equation*}
        \frac{\partial c_j}{\partial c_i} = 0 \quad \text{若} j \neq i, \quad \frac{\partial c_i}{\partial c_i} = 1
        \quad \text{若} j = i
    \end{equation*}
    \begin{equation}
        \frac{\partial c_j}{\partial c_i} = \delta_{ij}
        \label{eq:8.48}
    \end{equation}
    因此，我们有
    \begin{equation*}
        \frac{\partial}{\partial c_i}\sum_{j=1}^{n}\sum_{k=1}^{n} c_jc_kS_{jk} = \sum_{k=1}^{n}\sum_{j=1}^{n}c_k\delta_{ij}S_{jk} + \sum_{j=1}^{n}\sum_{k=1}^{n}c_j\delta_{ik}S_{jk} = \sum_{k=1}^{n}c_kS_{ik} + \sum_{j=1}^{n}c_jS_{ji}
    \end{equation*}
    其中，我们利用公式 (\ref{eq:7.32}) 求出了两次求和中的一次。使用(\ref{eq:7.4})，有
    \begin{equation}
        S_{ji} = S_{jk}^{\ast} = S_{ij}
        \label{eq:8.49}
    \end{equation}
    其中最后一个等式是因为我们处理的是实函数。因此，
    \begin{equation}
        \frac{\partial}{\partial c_i}\sum_{j=1}^{n}\sum_{k=1}^{n}c_jc_kS_{jk} = \sum_{k=1}^{n}c_kS_{ik} + \sum_{j=1}^{n}c_jS_{ij} = \sum_{k=1}^{n}c_kS_{ik} + \sum_{k=1}^{n}c_kS_{ik} = 2\sum_{k=1}^{n}c_kS_{ik}
        \label{eq:8.50}
    \end{equation}
    其中使用了$j$只是一个虚拟变量的性质。

    在这些操作中将$S_{jk}$替换为$H_{jk}$，我们得到
    \begin{equation}
        \frac{\partial}{\partial c_i}\sum_{j=1}^{n}\sum_{k=1}^{n}c_jc_kH_{jk} = 2\sum_{k=1}^{n}c_kH_{ik}
        \label{eq:8.51}
    \end{equation}
    该结果基于以下事实：
    \begin{equation}
        H_{ji} = H_{jk}^{\ast} = H_{ij}
        \label{eq:8.52}
    \end{equation}
    因为$\hat{H}$是厄米算符，$f_i$、$f_j$和$\hat{H}$都是实函数，因此上式成立。

    将(\ref{eq:8.47})、(\ref{eq:8.50})和(\ref{eq:8.51})代入(\ref{eq:8.47})，我们得到
    \begin{equation*}
        2W\sum_{k=1}^{n}c_kS_{ik} = 2\sum_{k=1}^{n}c_kH_{ik}, \quad i = 1,2,\ldots,n
    \end{equation*}
    \begin{equation}
        \sum_{k=1}^{n}\left[\left(H_{ik} - S_{ik}W\right)c_k\right] = 0, \quad i = 1,2,\ldots,n
        \label{eq:8.53}
    \end{equation}
    方程(\ref{eq:8.53})是一个关于$c_1,c_2,\ldots,c_n$的线性齐次方程组[线性变分函数(\ref{eq:8.40})中的系数]。例如，若$n=2$则(\ref{eq:8.53})变为
    \begin{equation}
        \begin{aligned}
            \left(H_{11} - S_{11}W\right)c_1 + \left(H_{12} - S_{12}W\right)c_2 &= 0 \\
            \left(H_{21} - S_{21}W\right)c_1 + \left(H_{22} - S_{22}W\right)c_2 &= 0
        \end{aligned}
        \label{eq:8.54}
    \end{equation}
    对于有$n$个函数$f_1,\ldots,f_n$的一般情况，(\ref{eq:8.53})为
    \begin{equation}
        \boxed{
            \begin{aligned}
                \left(H_{11}-S_{11}W\right)c_1 + \left(H_{12}-S_{12}W\right)c_2 + \cdots + \left(H_{1n}-S_{1n}W\right)c_n &= 0 \\
                \left(H_{21}-S_{21}W\right)c_1 + \left(H_{22}-S_{22}W\right)c_2 + \cdots + \left(H_{2n}-S_{2n}W\right)c_n &= 0 \\
                \ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots & \ldots\\
                \left(H_{n1}-S_{n1}W\right)c_1 + \left(H_{n2}-S_{n2}W\right)c_2 + \cdots + \left(H_{nn}-S_{nn}W\right)c_n &= 0
            \end{aligned}
        }
        \label{eq:8.55}
    \end{equation}

    根据第\ref{sec:8.4 Simultaneous Linear Equations}节的定理，若线性齐次方程(\ref{eq:8.55})有平凡解$0=c_1=c_2=\cdots=c_n=0$（这使得变分函数$\phi$为零）以外的解，那么系数行列式必须为零。对于$n=2$的情况，我们有
    \begin{equation}
        \begin{vmatrix}
            H_{11} - S_{11}W & H_{12} - S_{12}W \\
            H_{21} - S_{21}W & H_{22} - S_{22}W
        \end{vmatrix} = 0
        \label{eq:8.56}
    \end{equation}
    对于一般情况，有
    \begin{equation}
        \boxed{
            \det\left(H_{ij} - S_{ij}W\right) = 0
        }
        \label{eq:8.57}
    \end{equation}
    \begin{equation}
        \begin{vmatrix}
            H_{11} - S_{11}W & H_{12} - S_{12}W & \cdots & H_{1n} - S_{1n}W \\
            H_{21} - S_{21}W & H_{22} - S_{22}W & \cdots & H_{2n} - S_{2n}W \\
            \vdots & \vdots & \ddots & \vdots \\
            H_{n1} - S_{n1}W & H_{n2} - S_{n2}W & \cdots & H_{nn} - S_{nn}W
        \end{vmatrix} = 0
        \label{eq:8.58}
    \end{equation}
    将(\ref{eq:8.58})中的行列式展开，我们得到关于未知数$W$的$n$次代数方程。这个方程有$n$个根，可以证明它们都是实数。将这些根按照能量依次递增的顺序排列，我们将其表示为
    \begin{equation}
        W_1 \leq W_2 \leq \cdots \leq W_n
        \label{eq:8.59}
    \end{equation}
    如果我们把系统的束缚态按能量递增的顺序排列，就会得出
    \begin{equation}
        E_1 \leq E_2 \leq \cdots \leq E_n \leq E_{n+1} \leq \cdots
        \label{eq:8.60}
    \end{equation}
    其中的$E$表示各种状态的真是能量值。根据变分原理，我们知道$E_1 \leq W_1$。此外，可以证明[J. K. L. MacDonald, \textit{Phys. Rev.}, \textbf{43}, 830 (1933); R. H. Young, \textit{Int. J. Quantum Chem.}, \textbf{6}, 596 (1972); 见问题. 8.40]：
    \begin{equation}
        E_1 \leq W_1, \quad E_2 \leq W_2, \quad E_3 \leq W_3, \ldots, \quad E_n \leq W_n
        \label{eq:8.61}
    \end{equation}
    因此，线性变分法提供了系统最低 $n$ 个束缚态的能量上限。我们使用$W_1,W_2,\ldots,W_n$来表示最低态能量的近似值。如果需要更多状态的能量近似值，我们可以在试探函数$\phi$中添加更多的$f_k$。可以证明，添加更多的函数 $f_k$ 可以提高（或不改变）先前计算的能量的精确度。若$\phi = \sum_{k}c_kf_k$中的$f_k$构成一个完全集，那么我们就能得到系统的真实波函数。不幸的是，我们通常需要无数个函数才能得到一个完全集。

    量子化学家可能会在线性变分函数中使用几十、几百、几千甚至几百万个项，从而得到分子的精确结果。解(\ref{eq:8.58})[称为\textbf{久期方程}（secular equation）]及相关线性方程(\ref{eq:8.58})的一种有效方法是矩阵法(第\ref{sec:8.6 Matrices, Eigenvalues, and Eigenvectors}节)。

    为了获得基态波函数的近似，我们使用久期方程最小的根$W_1$，将其带入方程组(\ref{eq:8.55})，解得系数$c_1^{\left(1\right)}, c_2^{\left(1\right)}, \ldots, c_n^{\left(1\right)}$，其中我们添加了上标$^{(1)}$来与$W_1$相对应。[如前所述，我们只能确定系数之间的比值。根据$c_1^{\left(1\right)}$的值，我们可以得到$c_2^{\left(1\right)}, c_3^{\left(1\right)}, \ldots, c_n^{\left(1\right)}$的值，再通过归一化条件确定$c_1^{\left(1\right)}$。]找到了$c_k^{\left(1\right)}$之后，我们将$\phi_1 = \sum_{k=1}^{n}c_k^{\left(1\right)}f_k$作为基态波函数的近似。使用(\ref{eq:8.58})中更高的根并带入(\ref{eq:8.55})，可以得到激发态波函数的近似。可以证明，这些近似波函数是正交的（问题8.40）。

    求解 (\ref{eq:8.58}) 和 (\ref{eq:8.55}) 时，可通过使尽可能多的积分等于零来简化。我们可以通过将函数 $f_k$ 选为与$\hat{H}$相乘的某个算符$\hat{A}$的本征函数，使一些对角线外的 $H_{ij}$ 消失。如果 $f_i$ 和 $f_j$ 对应于 $\hat{A}$ 的不同本征值，则 $H_{ij}$ 消失（第 \ref{sec:7.4 Eigenfunctions of Commuting Operators} 节的定理 6 ）。如果函数 $f_k$ 是正交的，则对角线外的 $S_{ij}$ 消失（$S_{ij} = \delta_{ij}$）。如果最初选择的 $f_k$ 不是正交的，我们可以使用施密特（或其他）程序找出这些 $f_k$ 的 $n$ 个正交线性组合，然后使用正交化的函数。

    当取消变分函数为实函数的限制时，方程 (\ref{eq:8.55}) 和 (\ref{eq:8.58}) 也是成立的（问题8.39）。

    \begin{examplebox}
        \textbf{例题：}给第 \ref{sec:8.1 The Variation Theorem} 节第一个例题中的函数 $x(l-x)$ 添加函数，使其形成粒子在长度为 $l$ 的一维势箱中的线性变分函数，并求出最低四个状态的近似能量和波函数。

        在变分函数$\phi = \sum_{k=1}^{n}c_kf_k$中，我们选择$f_1 = x(l-x)$。由于我们希望知道最低四个状态的近似，$n$应至少为4。有无数种可能的品优函数可以用于$f_2$、$f_3$和$f_4$。函数$x^2\left(l-x\right)^2$满足在$x=0$和$x=l$处消失的定解条件，且对其积分较为简单，所以我们选择$f_2 = x^2\left(l-x\right)^2$。

        如果把原点放在势箱的中心，势能（图 \ref{fig:2.1}）就是偶函数，正如第 \ref{sec:8.2 Extension of the Variational Method} 节所述，波函数在偶函数和奇函数之间交替变化（另见图 \ref{fig:2.3}）。（在本例中，偶函数和奇函数指的是原点位于势箱中心。）函数$f_1 = x\left(l-x\right)$和$f_2 = x^2\left(l-x\right)^2$都是偶函数（见问题8.34）。若我们选择$\phi = c_1x\left(l-x\right) + c_2x^2\left(l-x\right)^2$，我们最终会得到波函数为偶函数的最低两个态的能量上限（$n=1$和$n=3$）并得到这两个状态波函数的近似。由于我们还需要$n=2$和$n=4$状态的近似，我们需要增加两个奇函数。如方程(\ref{eq:4.50})之后所述，奇函数必须在原点为零，所以我们必须要求函数在势箱中点$x=\frac{1}{2}l$处为零，与$x=0$和$x=l$一致。满足这些性质的一个简单函数为$f_3 = x\left(l-x\right)\left(\frac{1}{2}l-x\right)$。为了得到$f_4$，我们将$f_2$乘以$\left(\frac{1}{2}l-x\right)$。因此，由$\phi = \sum_{k=1}^{4}c_kf_k$组成的线性变分函数，其中
        \begin{equation}
            f_1 = x\left(l-x\right), \: f_2 = x^2\left(l-x\right)^2, \: f_3 = x\left(l-x\right)\left(\frac{1}{2}l-x\right), \: f_4 = x^2\left(l-x\right)^2\left(\frac{1}{2}l-x\right)
            \label{eq:8.62}
        \end{equation}
        如(\ref{eq:8.40})所假设的那样，$f_1$、$f_2$、$f_3$和$f_4$线性无关。

        因为$f_1$和$f_2$是偶函数，$f_3$和$f_4$是奇函数，所以许多积分都为零。因此，
        \begin{equation}
            S_{13} = S_{31} = 0, \quad S_{14} = S_{41} = 0, \quad S_{23} = S_{32} = 0, \quad S_{24} = S_{42} = 0
            \label{eq:8.63}
        \end{equation}
        因为这些重叠积分中的每一个积分的被积函数都是相对于方框中心原点的奇函数。函数$f_1$、$f_2$、$f_3$和$f_4$都是宇称算符$\hat{\Pi}$的本征函数(第\ref{sec:7.5 Parity}节)，其中，偶函数$f_1$和$f_2$对应于本征值$+1$，奇函数$f_3$和$f_4$对应于本征值$-1$。由于$V$是偶函数，所以$\hat{H}$和$\hat{\Pi}$对易，根据(\ref{sec:7.4 Eigenfunctions of Commuting Operators})节的定理6，若$f_i$是奇函数而$f_j$是偶函数时，$H_{ij}$为零，反之亦然。因此，
        \begin{equation}
            H_{13} = H_{31} = 0, \quad H_{14} = H_{41} = 0, \quad H_{23} = H_{32} = 0, \quad H_{24} = H_{42} = 0
            \label{eq:8.64}
        \end{equation}

        根据(\ref{eq:8.63})和(\ref{eq:8.64})，$n=4$的久期方程(\ref{eq:8.58})变为
        \begin{equation}
            \begin{vmatrix}
                H_{11} - S_{11}W & H_{12} - S_{12}W & 0 & 0 \\
                H_{21} - S_{21}W & H_{22} - S_{22}W & 0 & 0 \\
                0 & 0 & H_{33} - S_{33}W & H_{34} - S_{34}W \\
                0 & 0 & H_{43} - S_{43}W & H_{44} - S_{44}W
            \end{vmatrix} = 0
            \label{eq:8.65}
        \end{equation}
        久期行列式为块对角行列式，其值等于各个块的乘积[式(\ref{eq:8.34})]：
        \begin{equation*}
            \begin{vmatrix}
                H_{11} - S_{11}W & H_{12} - S_{12}W \\
                H_{21} - S_{21}W & H_{22} - S_{22}W
            \end{vmatrix} \times \begin{vmatrix}
                H_{33} - S_{33}W & H_{34} - S_{34}W \\
                H_{43} - S_{43}W & H_{44} - S_{44}W
            \end{vmatrix} = 0
        \end{equation*}
        该方程的四个根由以下两个方程给出：
        \begin{equation}
            \begin{vmatrix}
                H_{11} - S_{11}W & H_{12} - S_{12}W \\
                H_{21} - S_{21}W & H_{22} - S_{22}W
            \end{vmatrix} = 0
            \label{eq:8.66}
        \end{equation}
        \begin{equation}
            \begin{vmatrix}
                H_{33} - S_{33}W & H_{34} - S_{34}W \\
                H_{43} - S_{43}W & H_{44} - S_{44}W
            \end{vmatrix} = 0
            \label{eq:8.67}
        \end{equation}
        令(\ref{eq:8.66})的根为$W_1$和$W_2$，它们分别代表$n=1$和$n=3$的近似能量，同样地，令(\ref{eq:8.67})的根为$W_3$和$W_4$。在通过久期方程解出$W$后，我们将其逐一带入方程组(\ref{eq:8.55})以求得变分函数中的系数$c_k$。
        根据久期方程(\ref{eq:8.65})，带入$W_1$的方程组(\ref{eq:8.55})为
        \begin{subequations}
            \label{eq:8.68}
            \begin{equation}
                \left. \begin{aligned}
                    \left(H_{11} - S_{11}W_1\right)c^{\left(1\right)} + \left(H_{12} - S_{12}W_1\right)c^{\left(1\right)} &= 0 \\
                    \left(H_{21} - S_{21}W_1\right)c^{\left(1\right)} + \left(H_{22} - S_{22}W_1\right)c^{\left(1\right)} &= 0
                \end{aligned} \right\}
                \tag{8.68a}
                \label{eq:8.68a}
            \end{equation}
            \begin{equation}
                \left. \begin{aligned}
                    \left(H_{33} - S_{33}W_1\right)c^{\left(1\right)} + \left(H_{34} - S_{34}W_1\right)c^{\left(1\right)} &= 0 \\
                    \left(H_{43} - S_{43}W_1\right)c^{\left(1\right)} + \left(H_{44} - S_{44}W_1\right)c^{\left(1\right)} &= 0
                \end{aligned} \right\}
                \tag{8.68b}
                \label{eq:8.68b}
            \end{equation}
        \end{subequations}
        由于$W_1$是(\ref{eq:8.66})的根，方程组(\ref{eq:8.68a})的系数行列式[即(\ref{eq:8.66})中的行列式]为零。那么(\ref{eq:8.68a})有非平凡解$c_1^{\left(1\right)}$和$c_2^{\left(1\right)}$，然而，$W_1$不是(\ref{eq:8.67})的根，所以方程组(\ref{eq:8.68b})的系数行列式不为零。因此，(\ref{eq:8.68b})只有平凡解$c_3^{\left(1\right)} = c_4^{\left(1\right)} = 0$。则对应于根$W_1$的试探函数$\phi_1$的形式为$\phi_1 = \sum_{k=1}^{4}c_k^{\left(1\right)}f_k = c_1^{\left(1\right)}f_1 + c_2^{\left(1\right)}f_2$。根据同样的理由说明$\phi_3$是$f_1$和$f_2$的线性组合，而$\phi_2$和$\phi_4$分别是$f_3$和$f_4$的线性组合：
        \begin{equation}
            \begin{aligned}
                \phi_1 = c_1^{\left(1\right)}f_1 + c_2^{\left(1\right)}f_2, \quad & \phi_3 = c_1^{\left(3\right)}f_1 + c_2^{\left(3\right)}f_2 \\
                \phi_2 = c_3^{\left(2\right)}f_3 + c_4^{\left(2\right)}f_4, \quad & \phi_4 = c_3^{\left(4\right)}f_3 + c_4^{\left(4\right)}f_4
            \end{aligned}
            \label{eq:8.69}
        \end{equation}
        偶波函数$\psi_1$和$\psi_3$使用偶函数$f_1$和$f_2$的线性组合来近似，而奇波函数$\psi_2$和$\psi_4$使用奇函数$f_3$和$f_4$的线性组合来近似。

        \textit{当久期方程为块对角形式时，它可以分解成两个或多个较简单的久期方程，联立方程组(\ref{eq:8.55})也可以分解成两个或多个较简单的方程组。}

        为了从(\ref{eq:8.66})和(\ref{eq:8.67})中解出$W_1$、$W_2$、$W_3$和$W_4$，我们现在必须计算$H_{ij}$和$S_{ij}$。我们有
        \begin{equation*}
            H_{11} = \left\langle f_1 \middle| \hat{H} \middle| f_1 \right\rangle = \int_0^l x(l-x)\left(\frac{-\hbar^2}{2m}\right)\frac{\mathrm{d}^2}{\mathrm{d}x^2}\left[x(l-x)\right]\:\mathrm{d}x = \frac{\hbar^2 l^3}{6m}
        \end{equation*}
        \begin{equation*}
            S_{11} = \left\langle f_1 \middle| f_1 \right\rangle = \int_0^l x^2(l-x)^2\:\mathrm{d}x = \frac{l^5}{30}
        \end{equation*}
        其中用到了(\ref{eq:8.12})和(\ref{eq:8.13})。使用(\ref{eq:8.62})、(\ref{eq:8.49})和(\ref{eq:8.52})，我们可以计算出剩余的积分（问题8.35）：
        \begin{equation*}
            H_{12} = H_{21} = \left\langle f_2 \middle| \hat{H} \middle| f_1 \right\rangle = \hbar^2 l^5/30m, \quad H_{22} = \hbar^2 l^7/105m
        \end{equation*}
        \begin{equation*}
            H_{33} = \hbar^2 l^5/40m, \quad H_{44} = \hbar^2 l^9/1260m, \quad H_{34} = H_{43} = \hbar^2 l^7/280m
        \end{equation*}
        \begin{equation*}
            S_{12} = S_{21} = \left\langle f_1 \middle| f_2 \right\rangle = l^7/140, \quad S_{22} = l^9/630
        \end{equation*}
        \begin{equation*}
            S_{33} = l^7/840, \quad S_{44} = l^{11}/27720, \quad S_{34} = S_{43} = l^9/5040
        \end{equation*}

        方程(\ref{eq:8.66})变为
        \begin{equation}
            \begin{vmatrix}
                \frac{\hbar^2 l^3}{6m} - \frac{l^5}{30}W & \frac{\hbar^2 l^5}{30m} - \frac{l^7}{140}W \\
                \frac{\hbar^2 l^5}{30m} - \frac{l^7}{140}W & \frac{\hbar^2 l^7}{105m} - \frac{l^9}{630}W
            \end{vmatrix} = 0
            \label{eq:8.70}
        \end{equation}
        使用第\ref{sec:8.3 Determinants}节的定理4，为了消去分式，我们将行列式的第一行乘以$420m/l^3$，第二行乘以$1260m/l^5$，右侧乘以相同的因子，得到
        \begin{equation*}
            \begin{vmatrix}
                70\hbar^2 - 14ml^2W & 14\hbar^2 l^2 - 3ml^4W \\
                42\hbar^2 - 9ml^2W & 12\hbar^2  l^2 - 2ml^4W
            \end{vmatrix} = 0
        \end{equation*}
        \begin{equation*}
            m^2l^4W^2 - 56ml^2\hbar^2W + 252\hbar^4 = 0
        \end{equation*}
        \begin{equation}
            W = \left(\hbar^2/ml^2\right)\left(28 \pm \sqrt{532}\right) = 0.1250018h^2/ml^2, \quad 1.293495h^2/ml^2
            \label{eq:8.71}
        \end{equation}
        将积分带入(\ref{eq:8.67})，得到根（问题8.36）：
        \begin{equation}
            W = \left(\hbar^2/ml^2\right)\left(60 \pm \sqrt{1620}\right) = 0.5002930h^2/ml^2, \quad 2.5393425h^2/ml^2
            \label{eq:8.72}
        \end{equation}
        则$\left(ml^2/h^2\right)W$的近似值为0.1250018、1.293495、0.5002930和2.5393425，与最低四个能级的准确值[方程(\ref{eq:2.20 energy of one-dimensional box})]$\left(ml^2/h^2\right)E = 0.125$、0.5、1.125和$2$相比较。对于$n=1$、2、3和4，百分误差分别为$0.0014\%$、$0.059\%$、$15.0\%$和$27.0\%$。$n=1$和2的近似非常好，而$n=3$和4极差（lousy）。

        我们现在尝试求出对应于这些$W$值的近似波函数。将$W_1 = 0.1250018\hbar^2/ml^2$代入对应于(\ref{eq:8.71})的方程组(\ref{eq:8.68a})，我们得到(同除$h^2$后)
        \begin{equation}
            \begin{aligned}
                0.023095c_1^{\left(1\right)} - 0.020381c_2^{\left(1\right)}l^2 &= 0 \\
                -0.061144c_1^{\left(1\right)} + 0.053960c_2^{\left(1\right)}l^2 &= 0
            \end{aligned}
            \label{eq:8.73}
        \end{equation}
        例如，其中的第一个系数由下式求出：
        \begin{equation*}
            70\hbar^2 - 14ml^2W_1 = 70h^2/4\pi^2 - 14\left(0.1250018\right) = 0.023095h^2
        \end{equation*}
        要求解齐次方程 (\ref{eq:8.73})，我们可以按照第 \ref{sec:8.4 Simultaneous Linear Equations} 节末尾给出的步骤进行。将(\ref{eq:8.73})的第二个方程删去，将$c_2^{\left(1\right)}$项移到等号右边，解出系数的比值，我们得到
        \begin{equation*}
            c_1^{\left(1\right)} = k, \quad c_2^{\left(1\right)} = 1.133k/l^{2}
        \end{equation*}
        其中的$k$是常数。我们通过归一化条件来求出$k$：
        \begin{equation*}
            \begin{aligned}
                \left\langle \phi_1 \middle| \phi_1 \right\rangle &= 1 = \left\langle kf_1 + 1.133kf_2/l^2 \middle| kf_1 + 1.133kf_2/l^2 \right\rangle \\
                &= k^2\left(\left\langle f_1 \middle| f_1 \right\rangle + 2.266\left\langle f_1 \middle| f_2 \right\rangle /l^2 + 1.284 \left\langle f_2 \middle| f_2 \right\rangle /l^4\right) \\
                &= k^2\left(S_{11} + 2.266S_{12}/l^2 + 1.284S_{22}/l^4\right) = 0.05156 k^2l^5
            \end{aligned}
        \end{equation*}
        其中用到了之前求出的重叠积分值。因此$k = 4.404/l^{5/2}$，
        \begin{equation*}
            \phi_1 = c_1^{\left(1\right)}f_1 + c_2^{\left(1\right)}f_2 = 4.404f_1/l^{5/2} + 4.990f_2/l^{9/2}
        \end{equation*}
        \begin{equation}
            \phi_1 = l^{-1/2}\left[4.404\left(x/l\right)\left(1-x/l\right) + 4.990\left(x/l\right)^2\left(1-x/l\right)^2\right]
            \label{eq:8.74}
        \end{equation}
        其中用到了(\ref{eq:8.62})。

        在(\ref{eq:8.55})中轮流使用$W_2$、$W_3$和$W_4$，我们可以得到以下归一化线性变分函数（问题8.38），其中$X \equiv x/l$：
        \begin{equation}
            \begin{aligned}
                \phi_2 &= l^{-1/2}\left[16.78X\left(1-X\right)\left(\frac{1}{2} - X\right) + 71.85X^2\left(1-X^2\right)\left(\frac{1}{2} - X\right)\right] \\
                \phi_3 &= l^{-1/2}\left[28.65X\left(1-X\right) - 132.7X^2\left(1-X\right)^2\right] \\
                \phi_4 &= l^{-1/2}\left[98.99X\left(1-X\right)\left(\frac{1}{2} - X\right) - 572.3X^2\left(1-X\right)^2\left(\frac{1}{2} - X\right)\right]
            \end{aligned}
            \label{eq:8.75}
        \end{equation}
    \end{examplebox}

\section{矩阵、本征值和本征向量}
\label{sec:8.6 Matrices, Eigenvalues, and Eigenvectors}
    矩阵代数（第 \ref{sec:7.10 Matrices} 节）是英国数学家阿瑟·凯利（Arthur Cayley）在 1855-1858 年间发展起来的，是处理同时线性方程组和从一组变量到另一组变量的线性变换的简便方法。[在 1860 年获得教授职位之前的 14 年里，凯利一直靠当律师养活自己。在做律师期间，他发表了数百篇数学论文，并经常与他的律师同事约翰·约瑟夫·西尔维斯特（John Joseph Sylvester）讨论数学问题。西尔维斯特为矩形阵列创造了 “矩阵 ”一词（取自拉丁文中 “womb”一词），并于 1855 年获得数学教授职位。] 多年来，大多数物理学家都不知道矩阵代数，当海森堡在 1925 年发现矩阵力学版本的量子力学时，他并没有意识到他所处理的实体是矩阵。当他向玻恩展示自己的研究成果时，受过良好数学训练的玻恩认出海森堡使用的是矩阵。如今，矩阵代数已成为量子化学计算的重要工具，并广泛应用于物理学的大多数分支。

    线性非齐次方程组(\ref{eq:8.55})可以写成矩阵形式：
    \begin{equation}
        \begin{pmatrix}
            a_{11} & a_{12} & \cdots & a_{1n} \\
            a_{21} & a_{22} & \cdots & a_{2n} \\
            \vdots & \vdots & \ddots & \vdots \\
            a_{n1} & a_{n2} & \cdots & a_{nn}
        \end{pmatrix} \begin{pmatrix}
            x_1 \\
            x_2 \\
            \vdots \\
            x_n
        \end{pmatrix} = \begin{pmatrix}
            b_1 \\
            b_2 \\
            \vdots \\
            b_n
        \end{pmatrix}
        \label{eq:8.76}
    \end{equation}
    \begin{equation}
        \mathbf{A} \mathbf{x} = \mathbf{b}
        \label{eq:8.77}
    \end{equation}
    其中$\mathbf{A}$是系数矩阵，$\mathbf{x}$和$\mathbf{b}$都是列向量。利用矩阵乘法法则 (\ref{eq:7.107}) 很容易验证 (\ref{eq:8.35}) 和 (\ref{eq:8.76}) 的等价性。

    方阵$\mathbf{A}$的\textbf{行列式}（determinant）是一个所有元素与$\mathbf{A}$的元素完全一致的行列式。若$\det\mathbf{A} \neq 0$，则称矩阵$\mathbf{A}$是\textbf{非奇异的}（nonsingular）。

    $n$阶方阵的\textbf{逆矩阵}（inverse matrix）定义为与$\mathbf{A}$相乘得到单位矩阵的矩阵。将逆矩阵记为$\mathbf{A}^{-1}$，那么
    \begin{equation}
        \boxed{
            \mathbf{A}\mathbf{A}^{-1} = \mathbf{A}^{-1}\mathbf{A} = \mathbf{I}
        }
        \label{eq:8.78}
    \end{equation}
    其中$\mathbf{I}$是单位阵。可以证明，当且仅当$\det\mathbf{A} \neq 0$时，$\mathbf{A}^{-1}$才存在。（对于求$\mathbf{A}^{-1}$的高效方法，见 \textit{Press et al.}, Section 2.3 ; \textit{Shoup}, Section 3.3；问题8.51。许多电子表格都内置了计算逆矩阵的功能。）

    若(\ref{eq:8.76})中系数矩阵$\mathbf{A}$的$\det \mathbf{A} \neq 0$，则可以通过将$\mathbf{A}^{-1}$乘以(\ref{eq:8.77})的两边来得到$\mathbf{A}^{-1}\mathbf{A}\mathbf{x} = \mathbf{A}^{-1}\mathbf{b}$。由于矩阵乘法满足结合律（第\ref{sec:7.10 Matrices}节），我们得到了$\mathbf{A}^{-1}\left(\mathbf{Ax}\right) = \left(\mathbf{A}^{-1}\mathbf{A}\right)\mathbf{x} = \mathbf{I}\mathbf{x} = \mathbf{x}$。因此，将(\ref{eq:8.77})两边乘以$\mathbf{A}^{-1}$，我们得到$\mathbf{x} = \mathbf{A}^{-1}\mathbf{b}$作为线性非齐次方程组的一组解。

    线性变分法被广泛用于求近似分子波函数，而矩阵代数给出了求解线性变分法方程的计算效率最高的方法。若线性变分函数$\phi = \sum_{k=1}^{n}c_kf_k$中的$f_1,\ldots,f_n$是正交的，那么$S_{ij} = \int f_i^{\ast}f_j\:\mathrm{d}\tau = \delta_{ij}$，则使变分积分最小的系数$c_k$构成的齐次方程组(\ref{eq:8.55})变为
    \begin{subequations}
        \label{eq:8.79}
        \begin{equation}
            \begin{aligned}
                H_{11}c_1 + H_{12}c_2 + \cdots + H_{1n}c_n &= Wc_1 \\
                H_{21}c_1 + H_{22}c_2 + \cdots + H_{2n}c_n &= Wc_2 \\
                \vdots \\
                H_{n1}c_1 + H_{n2}c_2 + \cdots + H_{nn}c_n &= Wc_n
            \end{aligned}
            \tag{8.79a}
            \label{eq:8.79a}
        \end{equation}
        \begin{equation}
            \begin{pmatrix}
                H_{11} & H_{12} & \cdots & H_{1n} \\
                H_{21} & H_{22}& \cdots & H_{2n} \\
                \vdots & \vdots & \ddots & \vdots \\
                H_{n1} & H_{n2} & \cdots & H_{nn}
            \end{pmatrix} \begin{pmatrix}
                c_1 \\
                c_2 \\
                \vdots \\
                c_n
            \end{pmatrix} = W\begin{pmatrix}
                c_1 \\
                c_2 \\
                \vdots \\
                c_n
            \end{pmatrix}
            \tag{8.79b}
            \label{eq:8.79b}
        \end{equation}
        \begin{equation}
            \mathbf{H}\mathbf{c} = W\mathbf{c}
            \tag{8.79c}
            \label{eq:8.79c}
        \end{equation}
    \end{subequations}
    其中$\mathbf{H}$是方阵，其元素为$H_{ij} = \left\langle f_i \middle| \hat{H} \middle| f_j \right\rangle$，$\mathbf{c}$是系数$c_1,\ldots,c_n$组成的列向量。

    若
    \begin{equation}
        \boxed{
            \mathbf{A} \mathbf{c} = \lambda \mathbf{c}
        }
        \label{eq:8.80}
    \end{equation}
    其中$\mathbf{A}$是方阵，$\mathbf{c}$是至少有一个元素不为零的列向量，$\lambda$是标量，则我们称$\mathbf{c}$为\textbf{本征向量}（eigenvector）或\textbf{特征向量}（characteristic vector），$\lambda$为$\mathbf{A}$的\textbf{本征值}（eigenvalue）或\textbf{特征值}（characteristic value）。

    将(\ref{eq:8.80})与(\ref{eq:8.79c})相比较，求解$S_{ij} = \delta_{ij}$的线性变分问题等价于求解矩阵$\mathbf{H}$的本征值和本征向量。矩阵本征方程$\mathbf{H}\mathbf{c} = W\mathbf{c}$等价于齐次方程组(\ref{eq:8.55})，当且仅当$\det\left(H_{ij} - \delta_{ij}W\right) = 0$时的$c$有非平凡解[$S_{ij} = \delta_{ij}$的方程(\ref{eq:8.57})]。对于一般的$n$阶方阵$\mathbf{A}$，本征值对应满足的方程为
    \begin{equation}
        \boxed{
            \det\left(A_{ij} - \delta_{ij}\lambda\right) = 0
        }
        \label{eq:8.81}
    \end{equation}
    方程(\ref{eq:8.81})称为矩阵$\mathbf{A}$的\textbf{特征方程}（characteristic equation）。当我们展开(\ref{eq:8.81})中的$n$阶行列式时，就得到了一个$n$次多项式[称为\textbf{特征多项式}（characteristic polynomial）]，其最高次项为$\lambda^n$。特征多项式对$\lambda$有$n$个根（有些可能重合，有些可能为虚数），所以一个$n$阶方阵有$n$个本征值。[方阵$\mathbf{A}$的本征值组有时可以称为$\mathbf{A}$的\textit{谱}（spectrum）。]

    $\mathbf{H}$ 的矩阵方程 (\ref{eq:8.79c}) 与 $\mathbf{A}$ 的矩阵方程 (\ref{eq:8.80}) 相对应。$\mathbf{A}$ 的特征向量元素满足以下方程组，对应于 (\ref{eq:8.79a})：
    \begin{equation}
        \begin{aligned}
            A_{11}c_1 + A_{12}c_2 + \cdots + A_{1n}c_n &= \lambda c_1 \\
            \vdots \\
            A_{n1}c_1 + A_{n2}c_2 + \cdots + A_{nn}c_n &= \lambda c_n
            \label{eq:8.82}
        \end{aligned}
    \end{equation}
    对于每个不同的本征值，我们都有一组不同的方程 (\ref{eq:8.82}) 和一组不同的数 $c_1,c_2,\ldots,c_n$，从而得到一个不同的本征向量。
    \begin{quote}
        \small
        \noindent 如果矩阵的所有本征值都不同，则可以证明求解独立本征向量（见\textit{Strang}, Section 5.2），这里的线性无关是指没有导致 $n$ 个线性本征向量可以写成其他本征向量的线性组合。如果某些本征值相等，那么矩阵的线性无关本征向量可能少于 $n$ 个。量子力学中出现的矩阵通常是厄米矩阵（本节稍后将对这一术语进行定义），即使某些本征值相等，阶数为 $n$ 的厄米矩阵也总是具有 $n$ 个线性无关的本征向量（证明见\textit{Strang}, Section 5.6）。
    \end{quote}

    若$\mathbf{A}$是对角矩阵(对$i \neq j$有$a_{ij} = 0$)，则(\ref{eq:8.81})中的行列式为对角行列式。对角行列式的值等于其对角元素的乘积[式(\ref{eq:8.33})]，所以对角矩阵的特征方程为
    \begin{equation*}
        \left(a_{11} - \lambda\right)\left(a_{22} - \lambda\right)\cdots\left(a_{nn} - \lambda\right) = 0
    \end{equation*}
    该方程的根为$\lambda_1 = a_{11}$、$\lambda_2 = a_{22}$、$\ldots$、$\lambda_n = a_{nn}$。\textit{对角矩阵的本征值就是其对角元素。}（对于本征向量，见问题8.46。）

    若$\mathbf{c}$是$\mathbf{A}$的本征向量，很明显，$\mathbf{d} \equiv k\mathbf{c}$也是$\mathbf{A}$的本征向量，其中$k$是任意常数。若我们选择的$k$满足
    \begin{equation}
        \boxed{
            \sum_{i=1}^{n} \left|d_i^2\right| = 1
        }
        \label{eq:8.83}
    \end{equation}
    则列向量$\mathbf{d}$是\textbf{归一化的}（normalized）。若两个分别有$n$个元素的列向量$\mathbf{b}$和$\mathbf{c}$满足下式，则称它们是\textbf{正交的}（orthogonal）：
    \begin{equation}
        \boxed{
            \sum_{i=1}^{n} b_i^{\ast}c_i = 0
        }
        \label{eq:8.84}
    \end{equation}

    令变分方程(\ref{eq:8.79})中$\mathbf{H}$的$n$个本征值为$W_1,W_2,\ldots,W_n$，对应的本征向量为$\mathbf{c}^{\left(1\right)},\mathbf{c}^{\left(2\right)},\ldots,\mathbf{c}^{\left(n\right)}$。则
    \begin{equation}
        \mathbf{H}\mathbf{c}^{\left(i\right)} = W_i\mathbf{c}^{\left(i\right)}, \quad i = 1,2,\ldots,n
        \label{eq:8.85}
    \end{equation}
    其中$\mathbf{c}^{\left(i\right)}$是列向量，其元素为$c_1^{\left(i\right)},c_2^{\left(i\right)},\ldots,c_n^{\left(i\right)}$，基函数$f_1$是正交的。此外，设 $\mathbf{C}$ 为方阵，其列为 $\mathbf{H}$ 的本征向量；设 $\mathbf{W}$ 为对角矩阵，其对角元素为 $\mathbf{H}$ 的本征值：
    \begin{equation}
        \mathbf{C} = \begin{pmatrix}
            c_1^{\left(1\right)} & c_1^{\left(2\right)} & \cdots & c_1^{\left(n\right)} \\
            c_2^{\left(1\right)} & c_2^{\left(2\right)} & \cdots & c_2^{\left(n\right)} \\
            \vdots & \vdots & \ddots & \vdots \\
            c_n^{\left(1\right)} & c_n^{\left(2\right)} & \cdots & c_n^{\left(n\right)}
        \end{pmatrix}, \quad \mathbf{W} = \begin{pmatrix}
            W_1 & 0 & \cdots & 0 \\
            0 & W_2 & \cdots & 0 \\
            \vdots & \vdots & \ddots & \vdots \\
            0 & 0 & \cdots & W_n
        \end{pmatrix}
        \label{eq:8.86}
    \end{equation}
    则$n$个本征方程组(\ref{eq:8.85})可以写成单个方程：
    \begin{equation}
        \mathbf{H}\mathbf{C} = \mathbf{C}\mathbf{W}
        \label{eq:8.87}
    \end{equation}
    为了验证矩阵方程(\ref{eq:8.87})，我们需要证明矩阵$\mathbf{HC}$的每个元素$\left(\mathbf{HC}\right)_{ij}$等于矩阵$\mathbf{CW}$对应的元素$\left(\mathbf{CW}\right)_{ij}$。根据矩阵乘法规则(\ref{eq:7.107})，我们有$\left(\mathbf{HC}\right)_{ij} = \sum_{k}H_{ik}\left(\mathbf{C}\right)_{kj} = \sum_{k}H_{ik}c_k^{\left(j\right)}$。考虑本征方程$\mathbf{H}\mathbf{C} ^{\left(j\right)} = W_j\mathbf{c}^{\left(j\right)}$[式(\ref{eq:8.85})]，$\mathbf{H}\mathbf{c}^{\left(j\right)}$和$W_j\mathbf{c}^{\left(j\right)}$都是列矩阵。利用 (\ref{7.107}) 令每个列矩阵第 $i$ 行中的元素相等，我们有$\sum_{k}H_{ik}c_k^{\left(j\right)} = W_jc_i^{\left(j\right)}$。则
    \begin{equation*}
        \left(\mathbf{HC}\right)_{ij} = \sum_{k}H_{ik}c_k^{\left(j\right)} = W_jc_i^{\left(j\right)}, \quad \left(\mathbf{CW}\right)_{ij} = \sum_{k}\left(\mathbf{C}\right)_{ik}\left(\mathbf{W}\right)_{kj} = \sum_{k}c_i^{\left(k\right)}\delta_{kj}W_k = c_i^{\left(j\right)}W_j
    \end{equation*}
    则$\left(\mathbf{HC}\right)_{ij} = \left(\mathbf{CW}\right)_{ij}$，从而验证了矩阵方程(\ref{eq:8.87})。

    令矩阵$\mathbf{C}$有逆阵（见下文），我们可以将(\ref{eq:8.87})两边乘以$\mathbf{C}^{-1}$，得到$\mathbf{C}^{-1}\mathbf{HC} = \mathbf{C}^{-1}\left(\mathbf{CW}\right)$。[由于矩阵乘法不可对易，当我们对$\mathbf{HC} = \mathbf{CW}$两边乘以$\mathbf{C}^{-1}$时，必须把因子$\mathbf{C}^{-1}$放在$\mathbf{HC}$和$\mathbf{CW}$的左边（或右边）。] 得到了$\mathbf{C}^{-1}\mathbf{HC} = \mathbf{C}^{-1}\left(\mathbf{CW}\right) = \left(\mathbf{C}^{-1}\mathbf{C}\right)\mathbf{W} = \mathbf{I}\mathbf{W} = \mathbf{W}$：
    \begin{equation}
        \mathbf{C}^{-1}\mathbf{HC} = \mathbf{W}
        \label{eq:8.88}
    \end{equation}
    为了化简 (\ref{eq:8.88})，我们必须了解更多关于矩阵的知识。

    若方阵$\mathbf{B}$的所有元素满足$b_{mn} = b_{nm}$，则$\mathbf{B}$为\textbf{对称矩阵}（symmetric matrix）。对称矩阵的元素关于主对角线对称，例如，$b_{12} = b_{21}$。若方阵$\mathbf{D}$的所有元素满足$d_{mn} = d_{nm}^{\ast}$，则$\mathbf{D}$为\textbf{厄米矩阵}（Hermitian matrix）。例如，若
    \begin{equation}
        \mathbf{M} = \begin{pmatrix}
            2 & 5 & 0 \\
            5 & \mathrm{i} & 2\mathrm{i} \\
            0 & 2\mathrm{i} & 4
        \end{pmatrix}, \quad \mathbf{N} = \begin{pmatrix}
            6 & 1 + 2\mathrm{i} & 8 \\
            1 - 2\mathrm{i} & -1 & -\mathrm{i} \\
            8 & \mathrm{i} & 0
        \end{pmatrix}
        \label{eq:8.89}
    \end{equation}
    则$\mathbf{M}$是对称矩阵，$\mathbf{N}$是厄米矩阵。（注意：厄米矩阵的对角元素一定是实数：$d_{mm} = d_{mm}^{\ast}$。）\textbf{实矩阵}（real matrix）是指所有元素都是实数的矩阵。实厄米矩阵是对称矩阵。

    矩阵的\textbf{转置}（transpose）$\mathbf{A}^{\mathrm{T}}$（也写作$\tilde{\mathbf{A}}$）是通过交换 $\mathbf{A}$ 的行和列，使第 1 列变为第 1 行，第 2 列变为第 2 行，以此类推而形成的矩阵。矩阵$\mathbf{A}^{\mathrm{T}}$的元素$a_{mn}^{\mathrm{T}}$与$\mathbf{A}$的元素关系为$a_{mn}^{\mathrm{T}} = a_{nm}$。对于方阵，转置是通过将元素关于主对角线反映得到的。对称矩阵的转置等于其本身。因此，对于(\ref{eq:8.89})中的矩阵$\mathbf{M}$，我们有$\mathbf{M}^{\mathrm{T}} = \mathbf{M}$。

    矩阵$\mathbf{A}$的\textbf{复共轭}（complex conjugate）$\mathbf{A}^{\ast}$（国内主要写为$\bar{\mathbf{A}}$，译者注，下同）是通过将$\mathbf{A}$的每个元素取复共轭得到的矩阵。矩阵$\mathbf{A}$的\textbf{共轭转置}（conjugate transpose）$\mathbf{A}^{\dagger}$（国内主要写为$\mathbf{A}^H$）是通过将$\mathbf{A}^{\ast}$转置得到的矩阵，因此$\mathbf{A}^{\dagger} = \left(\mathbf{A}^{\ast}\right)^{\mathrm{T}}$以及
    \begin{equation}
        a_{mn}^{\dagger} = a_{nm}^{\ast}
        \label{eq:8.90}
    \end{equation}
    [物理学家将$\mathbf{A}^{\dagger}$称为$\mathbf{A}$的\textit{伴随矩阵}（adjoint matrix），是数学家用来表示一种完全不同的矩阵的名称。]例如，
    \begin{equation*}
        \mathbf{B} = \begin{pmatrix}
            2 & 3 + \mathrm{i} \\
            0 & 4\mathrm{i}
        \end{pmatrix}, \quad \mathbf{B}^{\mathrm{T}} = \begin{pmatrix}
            2 & 0 \\
            3 + \mathrm{i} & 4\mathrm{i}
        \end{pmatrix}, \quad \mathbf{B}^{\dagger} = \begin{pmatrix}
            2 & 0 \\
            3 - \mathrm{i} & -4\mathrm{i}
        \end{pmatrix}
    \end{equation*}

    对于厄米矩阵$\mathbf{A}$，根据(\ref{eq:8.90})，我们有$a_{mn}^{\dagger} = a_{nm}$，因此$\left(\mathbf{A}^{\dagger}\right)_{mn} = \left(\mathbf{A}\right)_{mn}$以及$\mathbf{A}^{\dagger} = \mathbf{A}$。因此，厄米矩阵的共轭转置等于它本身。[物理学家通常使用术语\textit{自伴随}（self-adjoint）来描述厄米矩阵。] 

    方阵的逆矩阵等于其转置的矩阵称为\textbf{正交矩阵}（orthogonal matrix）：
    \begin{equation}
        \mathbf{A}^{-1} = \mathbf{A}^{\mathrm{T}} \quad \text{若} \mathbf{A} \text{是正交矩阵}
        \label{eq:8.91}
    \end{equation}

    方阵的逆矩阵等于其共轭转置的矩阵称为\textbf{酉矩阵}（unitary matrix）：
    \begin{equation}
        \mathbf{U}^{-1} = \mathbf{U}^{\dagger} \quad \text{若} \mathbf{U} \text{是酉矩阵}
        \label{eq:8.92}
    \end{equation}
    根据定义(\ref{eq:8.92})，我们得出：若$\mathbf{U}$是酉矩阵，则$\mathbf{U}^{\dagger}\mathbf{U} = \mathbf{I}$。令$\left(\mathbf{U}^{\dagger}\mathbf{U}\right)_{mn} = \left(\mathbf{I}\right)_{mn}$，对于酉矩阵的$n$和$m$列，我们得到（问题8.43）：
    \begin{equation}
        \sum_{k} u_{km}^{\ast}u_{kn} = \delta_{mn}
        \label{eq:8.93}
    \end{equation}
    因此，根据 (\ref{eq:8.84}) 和 (\ref{eq:8.83}) 的定义，酉矩阵的各列（视为列向量）是正交和归一化（正交）的。相反地，若对所有的列都有(\ref{eq:8.93})成立，则$\mathbf{U}$是酉矩阵。若$\mathbf{U}$是实酉矩阵，则$\mathbf{U}^{\dagger} = \mathbf{U}^{\mathrm{T}}$，那么$\mathbf{U}$是正交矩阵。

    我们可以证明，厄米矩阵 $\mathbf{H}$ 对应不同本征值的两个本征向量是正交的（见\textit{Strang}, Section 5.5）。对于对应同一本征值的 $\mathbf{H}$ 的本征向量，可以取它们的线性组合，这些线性组合将成为 $\mathbf{H}$ 的正交本征向量。此外，本征向量的元素可以乘以一个常数，使本征向量归一化。因此，\textit{可以选择厄米矩阵的本征向量为正交向量，}那么(\ref{eq:8.86})中的本征向量矩阵$\mathbf{C}$是酉矩阵，则$\mathbf{C}^{-1} = \mathbf{C}^{\dagger}$。因此，(\ref{eq:8.88})可以写成
    \begin{equation}
        \mathbf{C}^{\dagger}\mathbf{H}\mathbf{C} = \mathbf{W} \quad \text{若} \mathbf{H} \text{是厄米矩阵}
        \label{eq:8.94}
    \end{equation}
    对于$\mathbf{H}$是实厄米矩阵（$\mathbf{H}$是实对称矩阵）的常见情况，(\ref{eq:8.79a})中的$c$都是实数（由于$W$和$H_{ij}$都是实数），$\mathbf{C}$是实酉矩阵，即$\mathbf{C}^{-1} = \mathbf{C}^{\mathrm{T}}$，则$\mathbf{C}$是正交的。那么(\ref{eq:8.94})可以写成
    \begin{equation}
        \mathbf{C}^{\mathrm{T}}\mathbf{H}\mathbf{C} = \mathbf{W} \quad \text{若} \mathbf{H} \text{是实对称矩阵}
        \label{eq:8.95}
    \end{equation}
    可以证明，厄米矩阵的本征值是实数（\textit{Strang}, Section 5.5）。

    \begin{examplebox}
        \textbf{例题：}通过求解代数方程，求以下厄米矩阵的本征值和归一化本征向量。并证明$\mathbf{C}^{\dagger}\mathbf{A}\mathbf{C}$是对角矩阵，其中$\mathbf{C}$是本征向量矩阵。
        \begin{equation*}
            \mathbf{A} = \begin{pmatrix}
                3 & 2\mathrm{i} \\
                -2\mathrm{i} & 0
            \end{pmatrix}
        \end{equation*}
        \\

        求本征值$\lambda$的特征方程(\ref{eq:8.81})为$\det(a_{ij} - \delta_{ij}\lambda) = 0$，带入，有
        \begin{equation*}
            \begin{vmatrix}
                3 - \lambda & 2\mathrm{i} \\
                -2\mathrm{i} & 0 - \lambda
            \end{vmatrix} = 0
        \end{equation*}
        \begin{equation*}
            \lambda^2 - 3\lambda - 4 = 0
        \end{equation*}
        \begin{equation*}
            \lambda_1 = 4, \quad \lambda_2 = -1
        \end{equation*}
        检查本征值计算的一个有用定理如下（\textit{Strang}, Exercise 5.1.9）：$n$阶方阵$\mathbf{A}$的本征值$\lambda_i$之和等于对角元素之和，即$\sum_{i=1}^{n}\lambda_i = \sum_{i=1}^{n}a_{ii}$。在本例中，$\sum_i a_{ii} = 3 + 0$等于本征值的和$4 - 1 = 3$。

        对于$\lambda_1=4$，联立方程组(\ref{eq:8.82})，得到
        \begin{equation*}
            \begin{aligned}
                \left(3-\lambda_1\right)c_1^{\left(1\right)} + 2\mathrm{i}c_2^{\left(1\right)} &= 0 \\
                -2\mathrm{i}c_1^{\left(1\right)} - \lambda_1 c_2^{\left(1\right)} &= 0
            \end{aligned}
        \end{equation*}
        或
        \begin{equation*}
            \begin{aligned}
                -c_1^{\left(1\right)} + 2\mathrm{i}c_2^{\left(1\right)} &= 0 \\
                -2\mathrm{i}c_1^{\left(1\right)} - 4c_2^{\left(1\right)} &= 0
            \end{aligned}
        \end{equation*}
        将这些方程的任意一个删去，我们得到
        \begin{equation*}
            c_1^{\left(1\right)} = 2\mathrm{i}c_2^{\left(1\right)}
        \end{equation*}
        根据归一化条件，有
        \begin{equation*}
            1 = |c_1^{\left(1\right)}|^2 + |c_2^{\left(1\right)}|^2 = 4|c_2^{\left(1\right)}|^2 + |c_2^{\left(1\right)}|^2
        \end{equation*}
        \begin{equation*}
            \left|c_2^{\left(1\right)}\right|^2 = 1/\sqrt{5}, \quad c_2^{\left(1\right)} = 1/\sqrt{5}
        \end{equation*}
        \begin{equation*}
            c_1^{\left(1\right)} = 2\mathrm{i}c_2^{\left(1\right)} = 2\mathrm{i}/\sqrt{5}
        \end{equation*}
        其中我们选择$c_2^{\left(1\right)}$的相位为零。

        同样地，对于$\lambda_2 = -1$，我们得到（问题8.49）：
        \begin{equation*}
            c_1^{\left(2\right)} = -\mathrm{i}/\sqrt{5}, \quad c_2^{\left(2\right)} = 2/\sqrt{5}
        \end{equation*}
        归一化本征向量为
        \begin{equation*}
            \mathbf{c}^{\left(1\right)} = \begin{pmatrix}
                2\mathrm{i}/\sqrt{5} \\
                1/\sqrt{5}
            \end{pmatrix}, \quad \mathbf{c}^{\left(2\right)} = \begin{pmatrix}
                -\mathrm{i}/\sqrt{5} \\
                2/\sqrt{5}
            \end{pmatrix}
        \end{equation*}

        由于厄米矩阵的两个本征值$\lambda_1$和$\lambda_2$不同，因此它们的本征向量$\mathbf{c}^{\left(1\right)}$和$\mathbf{c}^{\left(2\right)}$是正交的（需要你证明）。同样，$\mathbf{c}^{\left(1\right)}$和$\mathbf{c}^{\left(2\right)}$是归一化的。因此，$\mathbf{C}$是酉矩阵，$\mathbf{C}^{-1} = \mathbf{C}^{\dagger}$。构造$\mathbf{C}$及其共轭转置，我们有
        \begin{equation*}
            \begin{aligned}
                \mathbf{C}^{-1} \mathbf{AC} = \mathbf{C}^{\dagger} \mathbf{A} \mathbf{C} &= \begin{pmatrix}
                    2\mathrm{i}/\sqrt{5} & 1/\sqrt{5} \\
                    1/\sqrt{5} & 2/\sqrt{5}
                \end{pmatrix} \begin{pmatrix}
                    3 & 2\mathrm{i} \\
                    -2\mathrm{i} & 0
                \end{pmatrix} \begin{pmatrix}
                    2\mathrm{i}/\sqrt{5} & -\mathrm{i}/\sqrt{5} \\
                    1/\sqrt{5} & 2/\sqrt{5}
                \end{pmatrix} \\
                &= \begin{pmatrix}
                    -2\mathrm{i}/\sqrt{5} & 1/\sqrt{5} \\
                    \mathrm{i}/\sqrt{5} & 2/\sqrt{5}
                \end{pmatrix} \begin{pmatrix}
                    8\mathrm{i}/\sqrt{5} & \mathrm{i}/\sqrt{5} \\
                    4/\sqrt{5} & -2/\sqrt{5}
                \end{pmatrix}  = \begin{pmatrix}
                    4 & 0 \\
                    0 & -1
                \end{pmatrix}
            \end{aligned}
        \end{equation*}
        这是本征向量的对角矩阵。
    \end{examplebox}

    我们已经证明：若$\mathbf{H}$是实对称矩阵，本征值为$W_i$，正交本征向量为$\mathbf{c}^{\left(i\right)}$（即$\mathbf{Hc}^{\left(i\right)} = W_i\mathbf{c}^{\left(i\right)}$, $i = 1,2,\ldots,n$），则$\mathbf{C}^{\mathrm{T}}\mathbf{H}\mathbf{C} = \mathbf{W}$[式(\ref{eq:8.95})]，其中$\mathbf{C}$是实正交矩阵，其列为$\mathbf{c}^{\left(i\right)}$，$\mathbf{W}$是本征值$W_i$的对角矩阵。该定理的逆定理很容易证明：若$\mathbf{H}$是实对称矩阵，$\mathbf{B}$是实正交阵，且$\mathbf{B}^{\mathrm{T}}\mathbf{H}\mathbf{B} = \mathbf{\Lambda}$，则$\mathbf{B}$的列是$\mathbf{H}$的本征向量，$\mathbf{\Lambda}$的对角元素是$\mathbf{H}$的本征值。

    为了求$n$阶厄米矩阵的本征值和本征向量，我们可以使用以下任一步骤：(1)求特征方程$\det\left(H_{ij}\right.$ \\ $\left. - \delta_{ij}W\right) = 0$[式(\ref{eq:8.81})]，得到本征值$W_1,\ldots,W_n$。然后将每个$W_k$带入代数方程组(\ref{eq:8.79a})，解出第$k$个本征向量的元素$c_1^{\left(k\right)},c_2^{\left(k\right)},\ldots,c_n^{\left(k\right)}$。(2)寻找酉矩阵$\mathbf{C}$，使得$\mathbf{C}^{\dagger}\mathbf{H}\mathbf{C}$成为对角矩阵。$\mathbf{C}^{\dagger}\mathbf{H}\mathbf{C}$的对角元素是$\mathbf{H}$的本征值，$\mathbf{C}$的列是$\mathbf{H}$的正交本征向量。对于量子化学中出现的大型矩阵，步骤（2）[称为\textbf{矩阵对角化}（matrix diagonalization）]的计算速度比（1）快得多。
    \begin{quote}
        \small
        \noindent 展开特征行列式并求解特征方程不是求大矩阵本征值的好方法，原因之一是，对于大矩阵，特征多项式中一个系数的极小变化可能会导致本征值的巨大变化（见问题 8.54）。因此，我们可能需要将特征多项式中的系数计算到小数点后几百或几千位，才能得到精确到小数点后几位的本征值。虽然对于某些矩阵来说，矩阵元素值的微小变化可能会导致本征值的巨大变化，但我们可以证明：对于厄米矩阵来说，矩阵元素的微小变化始终只会导致本征值的微小变化。因此，上一段的方法（2）是获得准确本征值的正确方法。
    \end{quote}

    实对称矩阵 $\mathbf{H}$ 对角化的系统方法如下。构造一个正交阵$\mathbf{O}_1$使得矩阵$\mathbf{H}_1 \equiv \mathbf{O}_1^{\mathrm{T}}\mathbf{H}\mathbf{O}_1$在$\mathbf{H}$的$H_{12}$和$H_{21}$的对角元素为零。（由于$\mathbf{H}$是对称的，我们有$H_{12} = H_{21}$。同样地，变换后的矩阵$\mathbf{H}_1, \mathbf{H}_2 ,\ldots$也是对称的。）然后构造一个正交阵$\mathbf{O}_2$使得矩阵$\mathbf{H}_2 \equiv \mathbf{O}_2^{\mathrm{T}}\mathbf{H}_1\mathbf{O}_2$在$\mathbf{H}_1 = \mathbf{O}_2^{\mathrm{T}}\mathbf{O}_1^{\mathrm{T}}\mathbf{H}\mathbf{O}_1\mathbf{O}_2$的$\mathbf{H}_1$对角元素$\left(\mathbf{H}_1\right)_{13}$和$\left(\mathbf{H}_1\right)_{31}$为零，以此类推。不幸的是，当某对角元素在某一步中归零后，在前一步中归零的一些对角元素很可能会变成非零，因此我们必须返回并反复循环对角元素。一般来说，要使所有非对角元素都等于零，需要无限多的步骤。在实际操作中，如果在该步骤中归零的非对角元素的绝对值小于某个极小数，则跳过该步骤；如果所有非对角元素的绝对值都小于某个极小数，则停止该步骤。本征值就是变换后的矩阵$\ldots \mathbf{O}_3^{\mathrm{T}}\mathbf{O}_2^{\mathrm{T}}\mathbf{O}_1^{\mathrm{T}}\mathbf{H}\mathbf{O}_1\mathbf{O}_2\mathbf{O}_3\ldots$的对角元素，本征向量矩阵是乘积$\mathbf{O}_1\mathbf{O}_2\mathbf{O}_3\ldots$。该方法[称为\textit{循环雅可比法}（cyclic Jacobi method）]，在串行计算机上运行时，它处理大型矩阵的效率不高，但在并行计算机上运行时效率很高。

    \begin{quote}
        \small
        \noindent 与雅可比方法相比，更有效的实对称矩阵对角化方法首先是进行一系列正交变换，将原始矩阵 $\mathbf{H}$ 变换为对称三对角矩阵 $\mathbf{T}$。三对角矩阵是指除了主对角线上的元素（元素 $t_{ii}$）和主对角线上下对角线上的元素（分别为元素 $t_{i-1,i}$ 和 $t_{i+1,i}$）外，其他元素均为零的矩阵。$\mathbf{T}$ 与 $\mathbf{H}$ 之间的关系为 $\mathbf{T} = \mathbf{O}^{\mathrm{T}}\mathbf{TO}$，其中 $\mathbf{O}$ 是实正交矩阵，是从 $\mathbf{H}$ 到 $\mathbf{T}$ 的各个步骤中使用的正交矩阵的乘积。求对称三对角矩阵本征值的有效方法是 \textbf{QR} 法。在这里，$\mathbf{T}$ 表示为正交矩阵 $\mathbf{Q}$ 和上三角矩阵 $\mathbf{R}$（主对角线以下元素均为零）的乘积。通过一系列迭代步骤，矩阵收敛到一个对角矩阵，其对角元素是 $\mathbf{T}$ 的本征值，等于 $\mathbf{H}$ 的本征值（问题 8.55）。经过一定的改进，\textbf{QR} 方法是一种非常有效的寻找本征值和本征向量的方法（详见 \textit{Strang}, Section 5.3 and 7.3）。
    \end{quote}

    有关矩阵对角化程序和计算机程序的详细信息，见\textit{Press et al.}, Chapter 11 ; \textit{Acton}, Chapters 8 and 13 ; \textit{Shoup}, Chapter 4 .
    
    \textit{Press et al.}是科学和工程计算程序和计算机程序的主要汇编；该书旧版本的文本可在线免费查阅，网址是 \url{www.nr.com}。有关本书旧版本的评论，见 \url{amath.colorado.edu/computing/Fortran/numrec.html}。

    数学和科学计算程序可在 \url{www.netlib.org} 和 \url{gams.nist.gov} 网站上找到。可在 \url{archives.math.utk.edu} 下载免费的个人电脑数学软件以及 Mathcad 和 Maple 等商业软件的演示软件。

    使用矩阵代数求解非正交基函数时的线性变分方程的步骤见问题 8.57。

    Excel 电子表格可用于查找本征值和本征向量；见问题8.53。

    计算机代数系统，如 Maple、Mathematica 和 Mathcad 以及一些电子计算器都有内置命令，可以轻松找到本征值和本征向量。

    本节讨论的寻找矩阵本征值和本征向量的方法适用于阶次不超过 $10 ^3$ 的矩阵。在某些量子化学计算中会出现阶数不超过 $10^ 9$ 的矩阵，使用特殊方法可以求出这些矩阵的最低几个本征值和相应的本征向量（见第 \ref{sec:16.2 Configuration Interaction} 节）。

    如(\ref{eq:8.80})之后所述，对于以正交函数$f_i$为基的线性变分函数$\sum_{i=1}^{n}c_if_i$，由矩阵元素$\left\langle f_i \middle| \hat{H} \middle| \right\rangle$组成的矩阵$\mathbf{H}$的本征值是久期方程的根，对应于本征值$W_m$的本征向量给出了对应于$W_m$的线性变分函数的系数。问题 8.60 至 8.65 将线性变分法应用于双势阱和谐振子等问题，使用箱中粒子波函数作为基函数，并使用 Mathcad 等计算机代数程序求出 $\mathbf{H}$ 矩阵的本征值和本征向量。

    我们已经在线性变分法中讨论了矩阵对角化的问题。然而，\textit{找到任意厄米算符的本征值$a_k$和本征函数$g_k$ $\left(\hat{A}g_k = a_kg_k\right)$可以表述为一个矩阵对角化问题。}如果我们选择一个完全正交基函数组$\left\{f_i\right\}$，将本征函数展开为$g_k = \sum_{i}c_i^{\left(k\right)}f_i$，则（问题8.59）元素由$a_{ij} = \left\langle f_i \middle| \hat{A} \middle| f_j \right\rangle$组成的矩阵$\mathbf{A}$的本征值$a_k$也是算符$\hat{A}$的本征值，$\mathbf{A}$的本征向量$\mathbf{c}^{\left(k\right)}$的元素$c_i^{\left(k\right)}$是本征函数$g_k$在基函数$f_i$上的展开系数。

    本节材料进一步强调了线性算符与矩阵之间的对应关系，以及函数与列向量之间的对应关系 ( 第 \ref{sec:7.10 Matrices} 节 )。

    \begin{quote}
        \small
        \noindent  谷歌收录的网页的页面排名（PageRanks）是由谷歌通过构建某个矩阵（称为谷歌矩阵）并找到其对应本征值 1 的本征向量计算得出的。谷歌矩阵的阶数等于被索引网页的数量，在 2012 年介于 $10^{10.5}$ 和 $10^{11}$ 之间。本征向量的分量为 PageRanks。见 \url{www.ams.org/samplings/ featurecolumn/fcarc-pagerank}。
    \end{quote}

\section*{总结}

\section*{习题}